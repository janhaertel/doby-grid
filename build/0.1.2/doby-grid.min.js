// doby-grid.js 0.1.2
// (c) 2014 Evgueni Naverniouk, Globex Designs, Inc.
// Doby may be freely distributed under the MIT license.
// For all details and documentation:
// https://github.com/globexdesigns/doby-grid

!function(a){if("object"==typeof exports&&"undefined"!=typeof module)module.exports=a();else if("function"==typeof define&&define.amd)define([],a);else{var b;b="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:this,b.DobyGrid=a()}}(function(){return function a(b,c,d){function e(g,h){if(!c[g]){if(!b[g]){var i="function"==typeof require&&require;if(!h&&i)return i(g,!0);if(f)return f(g,!0);var j=new Error("Cannot find module '"+g+"'");throw j.code="MODULE_NOT_FOUND",j}var k=c[g]={exports:{}};b[g][0].call(k.exports,function(a){var c=b[g][1][a];return e(c?c:a)},k,k.exports,a,b,c,d)}return c[g].exports}for(var f="function"==typeof require&&require,g=0;g<d.length;g++)e(d[g]);return e}({1:[function(a,b,c){"use strict";var d=a("./../utils/classes.js"),e=a("./NonDataItem.js"),f=function(a){this.aggregators=a,this["class"]=d.rowtotal,this.columns={},this.editable=!1,this.focusable=!0,this.selectable=!1};f.prototype=new e,f.prototype._aggregateRow=!0,f.prototype.toString=function(){return"Aggregate"},f.prototype.exporter=function(a){if(this.aggregators[a.id]){var b;for(var c in this.aggregators[a.id])if(b=this.aggregators[a.id][c],b.active&&b.exporter)return b.exporter()}return""},f.prototype.formatter=function(a,b,c,d){if(this.aggregators[d.id]){var e;for(var f in this.aggregators[d.id])if(e=this.aggregators[d.id][f],e.active&&e.formatter)return e.formatter()}return""},b.exports=f},{"./../utils/classes.js":12,"./NonDataItem.js":7}],2:[function(a,b,c){"use strict";var d=a("./../utils/classes"),e=a("./../utils/removeElement"),f=function(a,b){this.$el=null,this.$stats=null,this.grid=a,this.getCellNodeBox=b};f.prototype.show=function(a){this.$el||(this.$el=$('<div class="'+d.rangedecorator+'"></div>').appendTo(this.grid.$el),this.$stats=$('<span class="'+d.rangedecoratorstat+'"></span>').appendTo(this.$el));var b=this.getCellNodeBox(a.fromRow,a.fromCell),c=this.getCellNodeBox(a.toRow,a.toCell),e=parseInt(this.$el.css("borderBottomWidth"),10),f=parseInt(this.$el.css("borderLeftWidth"),10),g=parseInt(this.$el.css("borderRightWidth"),10),h=parseInt(this.$el.css("borderTopWidth"),10),i=this.grid.$el.find("."+d.pane).eq(1),j=this.grid.$el.find("."+d.pane+":first ."+d.viewport).first().position().top,k=this.grid.options.frozenColumns,l=k>=0&&a.fromCell>k?i.position().left:0,m=k>=0&&a.toCell>k&&a.fromCell<=k?i.position().left:0;if(k>=0){var n=this.grid.$el.find("."+d.viewport).eq(1);a.fromCell>k?l-=n[0].scrollLeft:a.toCell>k&&(m-=n[0].scrollLeft)}if(b&&c){var o=c.right-b.left-f-g;this.$el.css({top:b.top+j,left:b.left+l,height:c.bottom-b.top-e-h,width:o+m}),o>200?this.$stats.show().html(["<strong>Selection:</strong> ",a.getCellCount()," cells"," <strong>From:</strong> ",a.fromRow+1,":",a.fromCell+1," <strong>To:</strong> ",a.toRow+1,":",a.toCell+1].join("")):this.$stats.hide()}return this.$el},f.prototype.hide=function(){this.$el&&this.$el.length&&e(this.$el[0]),this.$el=null},b.exports=f},{"./../utils/classes":12,"./../utils/removeElement":15}],3:[function(a,b,c){"use strict";var d=a("./../utils/classes"),e=function(a){var b=0;if(document.selection){a.focus();var c=document.selection.createRange();c.moveStart("character",-a.value.length),b=c.text.length}else{if(a.selectionStart!==a.selectionEnd)return null;(a.selectionStart||"0"==a.selectionStart)&&(b=a.selectionStart)}return b},f=function(a,b){return this.initialize=function(){this.loadValue(b.item);var a=this.currentValue;(null===a||void 0===a)&&(a=""),this.$input=$('<input type="text" class="'+d.editor+'" value="'+a+'"/>').appendTo(b.cell).on("keydown",function(a){if([9,13,33,34,35,36].indexOf(a.which)>=0)return void a.preventDefault();if(27!=a.which){var b=e(this);(null===b&&38!=a.which&&40!=a.which||b>0&&37===a.which||b<$(this).val().length&&39===a.which)&&a.stopImmediatePropagation()}})},this.applyValue=function(b,c){for(var d,e=0,f=b.length;f>e;e++)d=b[e],a.options.idProperty in d.item||d.column.field!=a.options.idProperty||(d.item[a.options.idProperty]=c),d.item instanceof Backbone.Model?d.item.set(d.column.field,c):d.item.data&&(d.item.data[d.column.field]=c)},this.cancel=function(){},this.destroy=function(){b.grid.$el.find("."+d.invalid).removeClass(d.invalid),this.$input.remove()},this.focus=function(){this.$input.focus().select()},this.getValue=function(){return this.$input.val()},this.isValueChanged=function(){return!(""===this.$input.val()&&null===this.currentValue)&&this.$input.val()!=this.currentValue},this.loadValue=function(a){if(!a)return null;var c=a instanceof Backbone.Model?a.get(b.column.field):a.data?a.data[b.column.field]:null;return this.currentValue=c||"",this.currentValue},this.serializeValue=function(){return this.$input.val()},this.setValue=function(a){this.$input.val(a)},this.showInvalid=function(a){for(var b,c=0,e=a.length;e>c;c++)b=a[c],b.$cell.append(['<span class="',d.invalidicon,'" title="',b.msg,'"></span>'].join("")),b.$cell.removeClass(d.invalid).width(),b.$cell.addClass(d.invalid)},this.validate=function(a,b){var c=[];0===c.length&&(c=!0),b(c)},this.initialize()};b.exports=f},{"./../utils/classes":12}],4:[function(a,b,c){"use strict";var d=function(a,b,c,d,e){return void 0===c||null===c?"":(c+"").replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;")};b.exports=d},{}],5:[function(a,b,c){"use strict";var d=a("./../utils/classes"),e=a("./../utils/removeElement"),f=function(a,b){return this.open=!1,this.initialize=function(){var c="doby-grid-"+Math.round(1e6*Math.random());this.$parent=b.parent||$(a.currentTarget),this.$el=b.menu,this.id=[c,d.dropdown,b.id].join("_");var e=null;this.$parent.data(d.dropdown)?(e=this.$parent.data(d.dropdown).filter(function(a){return a.id==this.id}.bind(this)),e&&(e=e[0])):this.$parent.data(d.dropdown,[]),e&&e.open?e.hide():(this.$el.attr("id",this.id),this.$el.addClass(["off",d.dropdown].join(" ")),this.show());var f;f=function(b){b.target!=a.target&&(this.hide(),$(document).off("click",f),$(document).off("context",f))}.bind(this),$(document).on("click",f),$(document).on("contextmenu",f);var g;return g=function(a){27==a.keyCode&&(this.hide(),$(document).off("keydown",g))}.bind(this),$(document).one("keydown",g),this},this.position=function(){var b=a.pageY,c=a.pageX,e=this.$el.outerWidth(),f=this.$el.outerHeight(),g=a.clientX+e,h=a.clientY+f,i=$(document.body),j=i.width(),k=i.height();g>j&&(c-=e),g+e>j&&this.$el.addClass(d.dropdownleft),h>k&&(b-=f),this.$el.css({left:Math.max(c,0),top:Math.max(b,0)});var l,m,n,o,p,q;this.$el.children("."+d.dropdownmenu+":first").find("."+d.dropdownmenu).each(function(){l=$(this).position(),m=$(this).offset(),n=$(this).outerHeight(),o=$(this).outerWidth(),q=$(this).parent().outerWidth(),p=m.left+q-Math.min(l.left,0)+o>j?"drop-left":"drop-right",$(this).addClass(p),"drop-left"==p&&$(this).css("left",-o+"px"),$(this).addClass(a.clientY+n>k?"drop-up":"drop-down")})},this.initialize()};f.prototype.show=function(){if(!this.open){this.$el.appendTo(document.body),this.position();var a=this.$parent.data(d.dropdown);a.push(this),this.$parent.data(d.dropdown,a),setTimeout(function(){this.$el.removeClass("off")}.bind(this),150),this.open=!0}},f.prototype.hide=function(){if(this.open&&this.$parent&&this.$parent.data(d.dropdown)){var a=this.$parent.data(d.dropdown).filter(function(a){return a!=this}.bind(this));this.$parent.data(d.dropdown,a),this.$el.addClass("off"),setTimeout(function(){e(this.$el[0])}.bind(this),150),this.open=!1}},b.exports=f},{"./../utils/classes":12,"./../utils/removeElement":15}],6:[function(a,b,c){"use strict";var d=a("./../utils/classes.js"),e=a("./NonDataItem.js"),f=function(a){a=a||{},$.extend(this,{count:0,groups:null,id:null,level:0,grouprows:[],selectable:!1,title:null,value:null},a),this.columns={0:{colspan:"*",focusable:!1,selectable:!1}},this.predef&&(void 0!==this.predef.height&&null!==this.predef.height&&(this.height=this.predef.height),void 0!==this.predef.rowSpacing&&null!==this.predef.rowSpacing&&(this.rowSpacing=this.predef.rowSpacing),void 0!==this.predef.colspan&&(this.columns[0].colspan=this.predef.colspan))};f.prototype=new e,f.prototype._groupRow=!0,f.prototype["class"]=function(a,b){var c=b.collapsed?d.collapsed:d.expanded,e=[d.group,this.options.collapsible?d.grouptoggle:null,c];return b.predef["class"]&&("function"==typeof b.predef["class"]?e.push(b.predef["class"].bind(this)(a,0,b.value,this.getActiveColumns()[0],b)):e.push(b.predef["class"])),e.join(" ")},f.prototype.toString=function(){return"Group"},b.exports=f},{"./../utils/classes.js":12,"./NonDataItem.js":7}],7:[function(a,b,c){"use strict";var d=function(a){this.__nonDataRow=!0,a&&$.extend(this,a)};d.prototype.toString=function(){return"NonDataItem"},b.exports=d},{}],8:[function(a,b,c){"use strict";var d=a("./NonDataItem"),e=function(){};e.prototype=new d,e.prototype.__placeholder=!0,e.prototype.toString=function(){return"Placeholder"},b.exports=e},{"./NonDataItem":7}],9:[function(a,b,c){"use strict";var d=a("./NonDataItem"),e=function(a,b){var c=a.fromRow,d=a.fromCell,e=void 0===a.toRow?a.fromRow:a.toRow,f=void 0===a.toCell?a.fromCell:a.toCell;this._grid=b,this.fromRow=Math.min(c,e),this.fromCell=Math.min(d,f),this.toRow=Math.max(c,e),this.toCell=Math.max(d,f),this.exclusions=[]};e.prototype.contains=function(a,b){return a>=this.fromRow&&a<=this.toRow&&(void 0===b||null===b||b>=this.fromCell&&b<=this.toCell&&!this.isExcludedCell(a,b))&&!this.isExcludedRow(a)},e.prototype.deselect=function(a,b){var c=void 0!==a&&null!==a&&void 0!==b&&null!==b,d=this._grid.getCache();if(c&&!this.contains(a,b))throw new Error("Unable to deselect cell ("+a+", "+b+") because it is not part of this Range.");if(c)this.exclusions.push([a,b]);else if(void 0!==a&&null!==a)for(var e=0,f=d.activeColumns.length;f>e;e++)this.exclusions.push([a,e]);var g=[];if(void 0===a||null===a)for(var h=this.fromRow;h<=this.toRow;h++)g.indexOf(h)<0&&g.push(h);else g.push(a);var i={},j={};if(void 0!==b&&null!==b)i[d.activeColumns[b].id]=this._grid.options.selectedClass;else for(var k=0,l=d.activeColumns.length;l>k;k++)i[d.activeColumns[k].id]=this._grid.options.selectedClass;for(var m=0,n=g.length;n>m;m++)j[g[m]]=i;return this._grid.updateCellCssStylesOnRenderedRows(null,j),this},e.prototype.excludeUnselectable=function(){for(var a=this.fromRow;a<=this.toRow;a++)for(var b=this.fromCell;b<=this.toCell;b++)this._grid.canCellBeSelected(a,b)||this.exclusions.push([a,b])},e.prototype.fullyExcluded=function(){for(var a=this.fromRow;a<=this.toRow;a++)for(var b=this.fromCell;b<=this.toCell;b++)if(!this.isExcludedCell(a,b))return!1;return!0},e.prototype.getCellCount=function(){for(var a,b=0,c=this._grid.getCache(),d=this.fromRow;d<=this.toRow;d++){a=c.nodes[d];for(var e=this.fromCell;e<=this.toCell;e++)a.cellColSpans.length&&a.cellColSpans[e]&&b++}return b},e.prototype.isExcludedCell=function(a,b){if(0===this.exclusions.length)return!1;for(var c=0,d=this.exclusions.length;d>c;c++)if(this.exclusions[c][0]===a&&this.exclusions[c][1]===b)return!0},e.prototype.isExcludedRow=function(a){if(0===this.exclusions.length)return!1;for(var b=[],c=this._grid.getCache(),d=0,e=this.exclusions.length;e>d;d++)this.exclusions[d][0]===a&&b.push(this.exclusions[d]);return b.length>=c.activeColumns.length},e.prototype.isSingleCell=function(){return this.fromRow==this.toRow&&this.fromCell==this.toCell},e.prototype.isSingleRow=function(){return this.fromRow==this.toRow},e.prototype.split=function(a,b){var c=null,d=null,f=null,g=null;return void 0!==a&&null!==a&&a>=0&&this.toCell>a?(c=new e({fromCell:this.fromCell,toCell:a,fromRow:this.fromRow,toRow:this.toRow},this._grid),d=new e({fromCell:a+1,toCell:this.toCell,fromRow:this.fromRow,toRow:this.toRow},this._grid)):c=new e({fromCell:this.fromCell,toCell:this.toCell,fromRow:this.fromRow,toRow:this.toRow},this._grid),a<this.fromCell&&d&&(c=null,d.fromCell=this.fromCell),void 0!==b&&null!==b&&b>=0&&this.toRow>b&&(c=new e({fromCell:c.fromCell,toCell:c.toCell,fromRow:this.fromRow,toRow:b},this._grid),f=new e({fromCell:c.fromCell,toCell:c.toCell,fromRow:b+1,toRow:this.toRow},this._grid),d&&(d=new e({fromCell:d.fromCell,toCell:d.toCell,fromRow:this.fromRow,toRow:b},this._grid),g=new e({fromCell:d.fromCell,toCell:d.toCell,fromRow:b+1,toRow:this.toRow},this._grid))),[c,d,f,g]},e.prototype.toCSV=function(){for(var a=this.toJSON(),b=[],c=0,d=a.length;d>c;c++)b.push('"'+a[c].join('","')+'"');return b.join("\n")},e.prototype.toJSON=function(){if(!this._grid.destroyed){for(var a,b,c,e=[],f=this._grid.getCache(),g=this.fromRow;g<=this.toRow;g++)if(b=f.rows[g],!(b instanceof d)){c=[];for(var h=this.fromCell;h<=this.toCell;h++)this.isExcludedCell(g,h)?c.push(null):(a=f.activeColumns[h],c.push(this._grid.getValueFromItem(b,a)));e.push(c)}return e}},e.prototype.toHTML=function(){var a=this.toJSON(),b=a.map(function(a){var b=a.map(function(a){return"		<td>"+a+"</td>"});return Array.prototype.concat("	<tr>",b,"	</tr>").join("\n")}),c=Array.prototype.concat("<table>",b,"</table>").join("\n");return c},e.prototype.toRows=function(){for(var a=[],b=this._grid.getCache(),c=this.fromRow;c<=this.toRow;c++)this.isExcludedRow(c)||a.push(b.rows[c]);return a},e.prototype.toString=function(){return this.isSingleCell()?"Range ("+this.fromRow+":"+this.fromCell+")":"Range ("+this.fromRow+":"+this.fromCell+" - "+this.toRow+":"+this.toCell+")"},b.exports=e},{"./NonDataItem":7}],10:[function(a,b,c){"use strict";var d=a("./../utils/classes"),e=a("./../utils/removeElement"),f=function(a,b){if(b=b||{},"popup"==b.type){if($(a.target).closest("."+d.handle).length)return void $(a.target).trigger("mouseleave");var c=b.column;if(c&&c.tooltip){var f=$(a.target).closest("."+d.headercolumn);if(!f.attr("aria-describedby")){var g,h="doby-grid-"+Math.round(1e6*Math.random()),i=h+"-tooltip-column-"+c.id;f.attr("aria-describedby",i),f.one("mouseleave remove",function(){if(clearTimeout(g),void 0!==$(this).attr("aria-describedby")){var a=$("#"+i);a.removeClass("on"),setTimeout(function(){a&&a.length&&e(a[0])},200),$(this).removeAttr("aria-describedby")}}),g=setTimeout(function(){if(void 0!==f.attr("aria-describedby")&&f.is(":visible")){var a=10,b=['<span class="'+d.tooltip+'" id="'+i+'">'];if(b.push(c.tooltip),b.push('<span class="'+d.tooltiparrow+'"></span>'),b.push("</span>"),!$("#"+i).length){var e=$(b.join(""));e.appendTo(document.body);var g=f.offset().left+f.outerWidth()/2-e.outerWidth()/2,h=f.offset().top+f.outerHeight()+a,j=0,k=$(window),l=k.outerWidth();0>g?(j=g,g=0):g+e.outerWidth()>l&&(j=g+e.outerWidth()-l,g-=j+1);var m=e.children("."+d.tooltiparrow).first();m.css("left",e.outerWidth()/2-m.outerWidth()/2+j),e.remove().addClass("on").attr("style","left:"+g+"px;top:"+(h+5)+"px").appendTo(document.body).width(),e.css("top",h)}}},250)}}}};b.exports=f},{"./../utils/classes":12,"./../utils/removeElement":15}],11:[function(a,b,c){"use strict";if(!$&&jQuery&&($=jQuery),!$)throw new Error("Unable to load DobyGrid because jQuery, which is a required dependency, could not be found.");if(!_)throw new Error("Unable to load DobyGrid because Underscore, which is a required dependency, could not be found.");if(!Backbone)throw new Error("Unable to load DobyGrid because Backbone, which is a required dependency, could not be found.");var d=a("./classes/Aggregate"),e=a("./classes/CellRangeDecorator"),f=a("./classes/DefaultEditor"),g=a("./classes/DefaultFormatter"),h=a("./classes/Dropdown"),i=a("./classes/Group"),j=a("./classes/NonDataItem"),k=a("./classes/Placeholder"),l=a("./classes/Range"),m=a("./classes/Tooltip"),n=a("./utils/classes"),o=a("./utils/locales"),p=a("./utils/naturalSort"),q=a("./utils/removeElement"),r=function(a){if(a=a||{},this.NAME="doby-grid",this.VERSION="0.1.2","object"!=typeof a||$.isArray(a))throw new TypeError('The "options" param must be an object.');"object"!=typeof window.console&&(window.console={});var b,c,r,s,t,u,v,w,x,y,z,A,B,C,D,E,F,G,H,I,J,K,L,M,N,O,P,Q,R,S,T,U,V,W,X,Y,Z,aa,ba,ca,da,ea,fa,ga,ha,ia,ja,ka,la,ma,na,oa,pa,qa,ra,sa,ta,ua,va,wa,xa,ya,za,Aa,Ba,Ca,Da,Ea,Fa,Ga,Ha,Ia,Ja,Ka,La,Ma,Na,Oa,Pa,Qa,Ra,Sa,Ta,Ua,Va,Wa,Xa,Ya,Za,$a,_a,ab,bb,cb,db,eb,fb,gb,hb,ib,jb,kb,lb,mb,nb,ob,pb,qb,rb,sb,tb,ub,vb,wb,xb,yb,zb,Ab,Bb,Cb,Db,Eb,Fb,Gb,Hb,Ib,Jb,Kb,Lb,Mb,Nb,Ob,Pb,Qb,Rb,Sb,Tb,Ub,Vb,Wb,Xb,Yb,Zb,$b,_b,ac,bc,cc,dc,ec,fc,gc,hc,ic,jc,kc,lc,mc,nc,oc,pc,qc,rc,sc,tc,uc,vc,wc,xc,yc,zc,Ac,Bc,Cc,Dc,Ec,Fc,Gc,Hc,Ic,Jc,Kc,Lc,Mc,Nc,Oc,Pc,Qc,Rc,Sc=this,Tc=-1,Uc={activeColumns:[],aggregatorsByColumnId:{},columnPosLeft:[],columnPosRight:[],columnsById:{},indexById:{},nodes:{},modelsById:{},postprocess:{},rowPositions:{},rows:[],stickyRows:[]},Vc=0,Wc=0,Xc=0,Yc=!1,Zc=0,$c=null,_c=null,ad=null,bd=!1,cd=!1,dd=0,ed=0,fd="function"==typeof window.Blob,gd=!1,hd=0,id=0,jd=0,kd=0,ld=null,md=null,nd=0,od=0,pd=null,qd=0,rd=0,sd=[],td=!1,ud=1,vd=this.NAME+"-"+Math.round(1e6*Math.random()),wd=1;a.locale=a.locale||{},a.locale=$.extend(!0,o,a.locale),this.options=$.extend({activeFollowsPage:!1,activateSelection:!0,addRow:!1,asyncEditorLoadDelay:100,asyncEditorLoading:!1,asyncPostRenderDelay:25,autoColumnWidth:!1,autoDestroy:!0,autoEdit:!0,autoHeight:!1,canvasFocus:!0,cacheNodes:!1,"class":null,clipboard:"csv",collapsible:!0,columns:[],columnSpacing:1,columnWidth:80,contextMenu:"all",cycleRowBasedSelection:!1,ctrlSelect:!0,data:[],dataExtractor:null,deactivateOnRightClick:!1,editable:!1,editor:null,editorType:"selection",emptyNotice:!0,exportFileName:"doby-grid-export",fetchCollapsed:!1,forceRemoteSort:!1,formatter:null,frozenBottom:!1,frozenColumns:-1,frozenRows:-1,fullWidthRows:!0,groupable:!0,idProperty:"id",infinitePageSize:35,keepNullsAtBottom:!0,keyboardNavigation:!0,lineHeightOffset:-1,nestedAggregators:!0,menuExtensions:null,menuExtensionsPosition:"bottom",minColumnWidth:"",multiColumnSort:!0,paginationStyle:"default",quickFilter:!1,remoteScrollTime:200,resizableColumns:!0,resizableRows:!1,resizeCells:!1,reorderable:!0,rowHeight:28,rowSpacing:0,rowBasedSelection:!1,rowsToPrefetch:0,scrollbarPosition:"right",scrollLoader:null,selectable:!0,selectedClass:"selected",selectOnNavigate:!1,shiftSelect:!0,showGutters:!1,showHeader:!0,showSortIndicator:!0,stickyFocus:!1,stickyGroupRows:!1,tooltipType:"popup",useDobySelect:!0,virtualScroll:!0},a);var xd={cache:!1,"class":null,comparator:null,editable:null,filterable:!0,focusable:!0,groupable:!0,headerClass:null,id:null,maxWidth:null,minWidth:42,name:"",postprocess:null,removable:!1,rerenderOnResize:!1,resizable:!0,selectable:!0,sortable:!0,sortAsc:!0,tooltip:null,visible:!0,width:null};return $.extend(this,Backbone.Events),this._event=null,this.active=null,this.currentEditor=null,this.destroyed=!1,this.fetcher=!1,this.selection=null,this.sorting=[],ub=function(){return Lc(),va(),Hc(),Sc.collection=new ba(Sc),Sc.options.addRow&&vb(),ha(),Sc.options.selectable&&!Sc.options.rowBasedSelection&&N(),Sc},this.activate=function(a,b){if(gd){if(void 0===a||void 0===b)return void gc();if(!(a>Ka()||0>a||b>=Uc.activeColumns.length||0>b)&&R(a,b))return mc(a,b,!1),sc(Aa(a,b),!1),this}},this.add=function(a,b){return this.collection.add(a,b),this},this.addColumn=function(a,b){if(!a||"object"!=typeof a||$.isArray(a)||a instanceof HTMLElement)throw new Error("Unable to addColumn() because the given 'data' param is invalid.");b=b||{};var c=Uc.columnsById[a.id];if(void 0!==c){if(b.merge!==!0){var d=["Unable to addColumn() because a column with id '"+a.id];throw d.push("' already exists. Did you want to {merge: true} maybe?"),new Error(d.join(""))}for(var e=0,f=this.options.columns.length;f>e;e++)this.options.columns[e].id==a.id&&$.extend(this.options.columns[e],a);return this}var g=this.options.columns;return null===b.at||void 0===b.at?g.push(a):g.splice(g,b.at,a),Sc.setColumns(g),this},this.addGrouping=function(a,b){if(!Sc.options.groupable)throw new Error('Cannot execute "addGrouping" because "options.groupable" is disabled.');if(b=b||{},null===a||void 0===a)throw new Error("Unable to add grouping to grid because the 'column_id' value is missing.");return sb(a)||(b.column_id=a,bd&&(bd=!1,this.collection.groups=[]),this.collection.groups.push(b),this.setGrouping(this.collection.groups)),this},this.appendTo=function(a){if(!a||!a.length)throw new Error('Doby Grid requires a valid container. "'+$(a).selector+'" does not exist in the DOM.');this.$el.appendTo(a);try{gd=!0,Rc=parseFloat($.css(this.$el[0],"width",!0)),Lb(),this.options.showHeader&&la(r),cc(),tc(),vc(),ga(),P(),ic(!0),"headerContent"===Sc.options.minColumnWidth&&sa(!0),this.fetcher&&(Ub(function(){0===D[0].scrollTop&&Vb()}.bind(this)),this.on("viewportchanged",function(a,b){b.scrollTopDelta>0&&Vb()})),this.$el.on("resize."+this.NAME,function(){ic(!0)}),this.options.autoDestroy&&this.$el.one("remove",function(){this.destroy()}.bind(this)),D.on("scroll",qb),this.options.showHeader&&(x.on("contextmenu",lb).on("click",mb),"title"!=this.options.tooltipType&&x.on("mouseover",function(a){new m(a,{column:Ha(a),type:Sc.options.tooltipType})})),$(document.body).on("click contextmenu",hb),b.on("keydown",Sc.options.rowBasedSelection&&Sc.options.handleKeyDownRowBased!==!1?ob:nb).on("click",ib).on("dblclick",kb).on("contextmenu",jb),yc();for(var c=["mousedown","mouseenter","mouseleave","mousemove","mouseout","mouseover","mouseup"],d=function(a){var b=xa(a),c=b&&void 0!==b.row&&null!==b.row?Sc.getRowFromIndex(b.row):null,d=b?Uc.activeColumns[b.cell]:null;if(Sc.trigger(a.type,a,{row:b?b.row:null,cell:b?b.cell:null,column:d,item:c}),"mouseup"==a.type&&Sc.options.canvasFocus){var e=document.activeElement;if(e!=this&&!$(this).has($(e)).length&&(Sc.options.quickFilter&&!$(e).closest("."+n.headerfiltercell).length||!Sc.options.quickFilter)){var f=[D.scrollLeft(),D.scrollTop()];$(this).focus(),D.scrollLeft()!=f[0]&&D.scrollLeft(f[0]),D.scrollTop()!=f[1]&&D.scrollTop(f[1])}}},e=0,f=c.length;f>e;e++)b.on(c[e],d);this.options.resizableRows&&O()}catch(g){console.error&&console.error(g)}return"header"==this.options.contextMenu?this.on("headercontextmenu",Fc):"all"==this.options.contextMenu&&(this.on("headercontextmenu",Fc),this.on("contextmenu",Fc)),$(window).on("resize",rb),this},I=function(a){if(gd&&Sc.options.showHeader){a||(a=r.children("."+n.headercolumn));var b=null;void 0!==u&&(b=u.children());var c,d,e,f;for(c=0,d=a.length;d>c;c++)e=Uc.activeColumns[c].width-dd,f=["width:",e,"px"].join(""),$(a[c]).attr("style",f),b&&b[c]&&$(b[c]).attr("style",f);Hc(!1)}},J=function(){var a,b,c,d,e,f,g,h=-1;for(r&&(r.children("."+n.columnspacer).remove(),"left"===Sc.options.scrollbarPosition&&Qc&&r.prepend('<span class="'+n.columnspacer+'" style="width:'+window.scrollbarDimensions.height+'px"></span>')),d=0,e=Uc.activeColumns.length;e>d;d++)a=Uc.activeColumns[d],b=a.width,c=Da(d),c.left.style.left=h+"px",f=(-1!=Sc.options.frozenColumns&&d>Sc.options.frozenColumns?U:T)-h-b-2,g=d+1===e||-1!=Sc.options.frozenColumns&&d===Sc.options.frozenColumns,!Qc&&"right"===Sc.options.scrollbarPosition&&g&&0>f&&(f=0),c.right.style.right=f+"px",Sc.options.frozenColumns==d?h=-1:h+=a.width+1},K=function(){I(),Sc.options.resizeCells&&J()},L=function(){for(var a=Ka(),b=function(){if(this.col.cache&&Uc&&Uc.rows[this.row]){var a=Uc.rows[this.row][Sc.options.idProperty];Uc.postprocess[a]||(Uc.postprocess[a]={}),Sc.options.cacheNodes?Uc.postprocess[a][this.col.id]=$(this.node).children():Uc.postprocess[a][this.col.id]=$(this.node).html()}};md>=ld;){var c,d=wd>=0?ld++:md--,e=Uc.nodes[d],f=Uc.rows[d];if(e&&!(d>=a)){Uc.postprocess[f[Sc.options.idProperty]]||(Uc.postprocess[f[Sc.options.idProperty]]={}),na(d);for(c in e.cellNodesByColumnIdx)if(e.cellNodesByColumnIdx.hasOwnProperty(c)){c=c||0;var g=Uc.activeColumns[c];f&&f.columns&&f.columns[c]&&(g=f.columns[c]);var h=g.postprocess,i=f.columns;if(i&&i[c]&&i[c].postprocess&&(h=i[c].postprocess),h&&!Uc.postprocess[f[Sc.options.idProperty]][g.id]){var j=e.cellNodesByColumnIdx[c];j&&j.length&&(j=j[0],h({$cell:$(j),column:g,data:Sc.getRowFromIndex(d),grid:Sc,rowIndex:d},b.bind({node:j,col:g,row:d})))}}return clearTimeout(ad),void(ad=setTimeout(L,Sc.options.asyncPostRenderDelay))}}},M=function(){var a,b,c,d,e,f,g=[],h=0,i=0,j=Qc?Rc-window.scrollbarDimensions.width:Rc;for(j-=Uc.activeColumns.length,a=0;a<Uc.activeColumns.length;a++)b=Uc.activeColumns[a],b.visible!==!1&&(g.push(b.width),i+=b.width,b.resizable&&(h+=b.width-Math.max(b.minWidth||0,G)));for(c=i;i>j&&h;){var k=(i-j)/h;for(a=0;a<Uc.activeColumns.length&&i>j;a++){b=Uc.activeColumns[a];var l=g[a];if(!(b.visible===!1||!b.resizable||l<=(b.minWidth||0)||G>=l)){var m=Math.max(b.minWidth,G),n=Math.floor(k*(l-m))||1;n=Math.min(n,l-m),i-=n,h-=n,g[a]-=n}}if(i>=c)break;c=i}for(c=i;j>i;){for(d=j/i,a=0;a<Uc.activeColumns.length&&j>i;a++)b=Uc.activeColumns[a],b.visible===!1||!b.resizable||b.maxWidth&&b.maxWidth<=b.width||(e=1e6,b.maxWidth&&b.maxWidth-b.width&&(e=b.maxWidth-b.width),f=Math.min(Math.floor(d*b.width)-b.width,e)||1,i+=f,g[a]+=f);if(c>=i)break;c=i}var o,p=!1;for(a=0;a<Uc.activeColumns.length;a++)o=Uc.activeColumns[a],o.visible!==!1&&(!p&&o.rerenderOnResize&&o.width!=g[a]&&(p=!0),Uc.activeColumns[a].width=g[a]);I(),Gc(!0),p&&(yb(),ac())},N=function(){var a=new e(Sc,Ba),c=null,d=function(){return $(this).closest("."+n.cellunselectable).length>0};b.on("draginit",{not:d},function(a){a.stopImmediatePropagation(),aa()}).on("dragstart",{not:d},function(b,d){var e=xa(b);if(e&&(Sc.canCellBeSelected(e.row,e.cell)&&(c=!0,b.stopImmediatePropagation()),c)){var f=$(this).closest(B),g=za(d.startX-$(this).offset().left+f.position().left,d.startY-$(this).offset().top);return d._range={end:g,start:g},a.show(new l({fromRow:g.row,fromCell:g.cell},Sc))}}).on("drag",{not:d},function(b,d){if(c){b.stopImmediatePropagation();var e=$(this).closest(B),f=b.pageX-$(this).offset().left,g=e.position().left;d._range.start.cell<=Sc.options.frozenColumns&&f>D.eq(0).width()&&(g+=D.eq(1)[0].scrollLeft);var h=za(f+g,b.pageY-$(this).offset().top);Sc.canCellBeSelected(h.row,h.cell)&&(d._range.end=h,a.show(new l({fromRow:d._range.start.row,fromCell:d._range.start.cell,toRow:h.row,toCell:h.cell},Sc)),Sc.options.activateSelection&&R(h.row,h.cell)&&sc(Aa(h.row,h.cell),!1))}}).on("dragend",{not:d},function(b,d){c&&(c=!1,b.stopImmediatePropagation(),a.hide(),Sc._event=b,b.shiftKey||ja(),Sc.selectCells(d._range.start.row,d._range.start.cell,d._range.end.row,d._range.end.cell,b.shiftKey),Sc._event=null,Sc.options.activateSelection&&Hb())})},O=function(){b.on("dragstart",function(a,b){$(a.target).hasClass(n.rowhandle)&&(a.stopImmediatePropagation(),b._row=Ta($(a.target).parent()[0]),b._rowNode=Uc.nodes[b._row].rowNode,b._rowsBelow=[],$(b._rowNode).siblings().each(function(){var a=Ta(this);a>b._row&&b._rowsBelow.push(this)}),$(b._rowsBelow).wrapAll('<div class="'+n.rowdragcontainer+'"></div>'),b._container=$(b._rowsBelow).parent())}).on("drag",function(a,b){if(void 0!==b._row){var c=b._rowNode,d=Uc.rowPositions[b._row],e=d.height||Sc.options.rowHeight;b._height=e+b.deltaY,b._height<5&&(b._height=5),$(c).height(b._height),$(c).css("line-height",b._height+Sc.options.lineHeightOffset+"px"),b._container.css({marginTop:b._height-e+"px"})}}).on("dragend",function(a,b){void 0!==b._row&&($(b._rowsBelow).unwrap(),uc(b._row,b._height))})},P=function(a,b){a=a||0,0===a&&(Uc.indexById={},!b&&Nc&&(Uc.rowPositions={0:{top:Sc.options.rowSpacing,height:Sc.options.rowHeight,bottom:Sc.options.rowHeight+Sc.options.rowSpacing,spacing:Sc.options.rowSpacing}}));for(var c,d,e,f=a,g=Uc.rows.length;g>f;f++)c=Uc.rows[f],Uc.indexById[c[Sc.options.idProperty]]=f,!b&&Nc&&(d={top:Uc.rowPositions[f-1]?Uc.rowPositions[f-1].bottom-jd:0},d.top+=0===f?0:1,e=null!==c.rowSpacing&&void 0!==c.rowSpacing?c.rowSpacing:Sc.options.rowSpacing,"function"==typeof e&&(e=e(c)),d.spacing=e,d.top+=e,null!==c.height&&void 0!==c.height&&c.height!=Sc.options.rowHeight&&("function"==typeof c.height?d.height=c.height(c):d.height=c.height),d.bottom=d.top+(null!==d.height&&void 0!==d.height?d.height:Sc.options.rowHeight),Uc.rowPositions[f]=d)},Q=function(){if(Sc.options.autoHeight)return void(Pb=Sc.collection.length);if(Nc){var a=D[0].scrollTop,b=Ua(Oc+a);Pb=b-Ua(a)}else Pb=Math.floor(Oc/(Sc.options.rowHeight+1+Sc.options.rowSpacing))},R=function(a,b){if(!Sc.options.keyboardNavigation||a>=Ka()||0>a||b>=Uc.activeColumns.length||0>b)return!1;var c=Sc.getRowFromIndex(a);if("boolean"==typeof c.focusable)return c.focusable;var d=c.columns;return d&&d[Uc.activeColumns[b].id]&&"boolean"==typeof d[Uc.activeColumns[b].id].focusable?d[Uc.activeColumns[b].id].focusable:d&&d[b]&&"boolean"==typeof d[b].focusable?d[b].focusable:Uc.activeColumns[b].focusable},this.canCellBeSelected=function(a,b){if(a>=Ka()||0>a||b>=Uc.activeColumns.length||0>b)return!1;var c=Sc.getRowFromIndex(a);if("boolean"==typeof c.selectable)return c.selectable;var d=c.columns&&(c.columns[Uc.activeColumns[b].id]||c.columns[b]);return d&&"boolean"==typeof d.selectable?d.selectable:Uc.activeColumns[b].selectable},V=function(a,b){return!(0>a||a>=Ka()||0>b||b>=Uc.activeColumns.length)},X=function(a){for(var b,c,d,e=[],f=[],g=0,h=a.top,i=a.bottom;i>=h;h++)if(b=Uc.nodes[h]){na(h),Y(a,h),c=0;for(var j=Sc.getRowFromIndex(h),k=j.columns,l=0,m=Uc.activeColumns.length;m>l&&!(Uc.columnPosLeft[l]>a.rightPx);l++)if(d=b.cellColSpans[l],null===d||void 0===d){if(d=1,k){var n=k[Uc.activeColumns[l].id]||k[l];d=n&&n.colspan||1,"*"===d&&(d=m-l)}Uc.columnPosRight[Math.min(m-1,l+d-1)]>a.leftPx&&(bc(e,h,l,d,j),c++),l+=d>1?d-1:0}else l+=d>1?d-1:0;c&&(g+=c,f.push(h))}if(e.length){var o=document.createElement("div");o.innerHTML=e.join("");for(var p,q,r;null!==(p=f.pop())&&void 0!==p;)for(b=Uc.nodes[p];null!==(r=b.cellRenderQueue.pop())&&void 0!==r;)q=o.lastChild,b.rowNode[0].appendChild(q),b.cellNodesByColumnIdx[r]=q}},Y=function(a,b){var c=0,d=Uc.nodes[b],e=[];for(var f in d.cellNodesByColumnIdx)if(d.cellNodesByColumnIdx.hasOwnProperty(f)){f=0|f;var g=d.cellColSpans[f];(Uc.columnPosLeft[f]>a.rightPx||Uc.columnPosRight[Math.min(Uc.activeColumns.length-1,f+g-1)]<a.leftPx)&&(!Sc.active||b==Sc.active.row&&f==Sc.active.cell||e.push(f))}for(var h;null!==(h=e.pop())&&void 0!==h&&h;)d.rowNode[0].removeChild(d.cellNodesByColumnIdx[h][0]),delete d.cellColSpans[h],delete d.cellNodesByColumnIdx[h],Uc.postprocess[Uc.rows[b].id]&&delete Uc.postprocess[Uc.rows[b].id][Uc.activeColumns[h].id],c++},Z=function(a){var b=Sc.active&&"row"in Sc.active?Sc.active.row:null;for(var c in Uc.nodes)(c=parseInt(c,10))!==b&&(c<a.top||c>a.bottom)&&_b(c)},aa=function(){if(document.selection&&document.selection.empty)try{document.selection.empty()}catch(a){}else if(window.getSelection){var b=window.getSelection();b&&b.removeAllRanges&&b.rangeCount>0&&b.getRangeAt(0).getClientRects.length>0&&b.removeAllRanges()}},this.commitCurrentEdit=ea=function(a){if(!Sc.active||!Sc.currentEditor)return a(!0);var b=Sc.getRowFromIndex(Sc.active.row),c=Uc.activeColumns[Sc.active.cell],d=function(){var a=[],d=!1;if("selection"==Sc.options.editorType&&Sc.selection)for(var e=0,f=Sc.selection.length;f>e;e++)for(var g=Sc.selection[e].fromRow,h=Sc.selection[e].toRow;h>=g;g++)for(var i=Sc.selection[e].fromCell,j=Sc.selection[e].toCell;j>=i;i++)Bb(g,i)&&(g==Sc.active.row&&i==Sc.active.cell&&(d=!0),a.push({item:Uc.rows[g],column:Uc.activeColumns[i],row:g,cell:i,$cell:$(Aa(g,i))}));return!d&&Bb(Sc.active.row,Sc.active.cell)&&a.push({item:b,column:c,row:Sc.active.row,cell:Sc.active.cell,$cell:$(Aa(Sc.active.row,Sc.active.cell))}),a},e=function(a){Sc.currentEditor.showInvalid&&Sc.currentEditor.showInvalid(a),Sc.trigger("validationerror",Sc._event,{editor:Sc.currentEditor,cellNode:Sc.active.node,validationResults:a,row:Sc.active.row,cell:Sc.active.cell,column:c}),Sc.currentEditor.focus()};if(Sc.currentEditor.isValueChanged()){var f=d();Sc.currentEditor.validate(f,function(d){if(d===!0){if(b.__addRow){var g={data:{}};if(Sc.currentEditor.applyValue([{item:g,column:c,row:Sc.active.row,cell:Sc.active.cell,$cell:$(Aa(Sc.active.row,Sc.active.cell))}],Sc.currentEditor.serializeValue()),!g.data.id&&!g.id||g.id in Uc.indexById||g.data.id in Uc.indexById)return e([{row:Sc.active.row,cell:Sc.active.cell,$cell:$(Aa(Sc.active.row,Sc.active.cell)),
msg:"Unable to create a new item without a unique 'id' value."}]);Sc.add(g),Sc.trigger("newrow",Sc._event,{cell:Sc.active.cell,column:c,item:g,row:Sc.active.row})}else{Sc.currentEditor.applyValue(f,Sc.currentEditor.serializeValue());for(var h=0,i=f.length;i>h;h++)Ic(f[h].row),Sc.trigger("change",Sc._event,{row:f[h].row,cell:f[h].cell,item:f[h].item})}Object.keys(Uc.aggregatorsByColumnId).length>0&&(hc(),Sc.options.data instanceof Backbone.Collection||Sc.collection.refresh()),ja(),Ib(),a(!0)}else e(d),a(!1)})}else a(!0);return!0},fa=function(){var a;if(Sc.selection){if(Sc.selection.length>1)return alert("Sorry, you cannot copy multiple selections.");switch(Sc.options.clipboard){case"csv":a=Sc.selection[0].toCSV();break;case"json":a=JSON.stringify(Sc.selection[0].toJSON());break;case"html":a=Sc.selection[0].toHTML()}}if(!a&&Sc.active&&Sc.active.node){var b=Ta(Sc.active.node.parentNode),c=ya(Sc.active.node),d=Uc.rows[b],e=Uc.activeColumns[c];a=Sc.getValueFromItem(d,e)}a&&$('<textarea class="'+n.clipboard+'"></textarea>').val(a).appendTo(Sc.$el).focus().select().on("keyup",function(){q(this)})},ga=function(){C=$('<style type="text/css" rel="stylesheet"></style>').appendTo($("head"));for(var a=Sc.options.rowHeight-Vc,b=["#"+vd+" ."+n.row+"{height:"+a+"px;line-height:"+(a+Sc.options.lineHeightOffset)+"px}"],c=0,d=Uc.activeColumns.length;d>c;c++)b.push("#"+vd+" .l"+c+"{}"),b.push("#"+vd+" .r"+c+"{}");C[0].appendChild(document.createTextNode(b.join("\n")))},ha=function(){var a=[Sc.NAME];Sc.options["class"]&&a.push(Sc.options["class"]),"left"===Sc.options.scrollbarPosition&&a.push(n.left),Sc.options.showGutters&&a.push(n.guttersVisible),Sc.$el=$('<div class="'+a.join(" ")+'" id="'+vd+'"></div>');var d,e,f,g=["top-left","top-right","bottom-left","bottom-right"];B=$(),D=$(),b=$(),c=$();for(var h=0,i=g.length;i>h;h++){if(d=$(['<div class="',n.pane," ",n.pane,"-",g[h],'"></div>'].join("")).appendTo(Sc.$el),e=$(['<div class="',n.viewport,Sc.options.autoHeight?" "+n.autoheight:"",Sc.options.frozenColumns>-1&&h%2===0?" "+n.autoheight:"",'"></div>'].join("")).appendTo(d),Sc.options.showGutters){var j='<div class="'+n.gutter+'"></div>',k=$(j).addClass("left").appendTo(e),l=$(j).addClass("right").appendTo(e);c=c.add(k).add(l)}f=$('<div class="'+n.canvas+'" tabindex="0"></div>').appendTo(e),B=B.add(d),D=D.add(e),b=b.add(f)}Sc.options.showHeader&&(y=$('<div class="'+n.header+'"></div>'),B.eq(0).prepend(y),z=$('<div class="'+n.header+'"></div>'),B.eq(1).prepend(z),x=$().add(y).add(z),s=$('<div class="'+n.headercolumns+'"></div>').appendTo(y).width(Pa()),t=$('<div class="'+n.headercolumns+'"></div>').appendTo(z).width(Pa()),r=$().add(s).add(t))},ia=function(a,b){if(!a)throw new Error("Unable to create group because grouping object is missing.");if(!b&&void 0===a.column_id)throw new Error("Unable to create grouping object because 'column_id' is missing.");var c=Ca(a.column_id),d=$.extend({collapsed:!0,comparator:function(a,b){if(Sc.options.keepNullsAtBottom){if(null===a.value)return 1;if(null===b.value)return-1}for(var c=!0,d=0,e=Sc.sorting.length;e>d;d++)if(Sc.sorting[d].columnId==a.predef.column_id){c=Sc.sorting[d].sortAsc;break}var f=p(a.value,b.value);return c?f:-f},getter:!b&&function(a){return Ja(a,c)},rows:[]},a);return b||(d.column_id=c.id),d},ba=function(a){var b,c,e,f,g,h,k,l,m,o,p,q,r,s,t=this,u=[],v=[],w=":|:",x={},y={},z=null,B=!0,C=[],D=0,E=null;return $.extend(this,Backbone.Events),this.items=[],this.filter=null,this.groups=[],this.length=0,this.initialize=function(){return!a.fetcher&&a.options.data&&t.reset(a.options.data),this},this.add=function(b,c){$.isArray(b)||(b=b?[b]:[]),c=c||{};var d,e,f=c.at,g=[];m(b),td=!0;for(var h=0,i=b.length;i>h;h++)if(d=b[h],e=this.get(d),e&&(e=e[1]),a.fetcher&&void 0!==f&&this.items[f+h]&&this.items[f+h].__placeholder&&(e=this.items[f+h]),e){if(!c.merge)throw new Error(["You are not allowed to add() items without a unique '",a.options.idProperty,"' value. ","A row with id '",e[a.options.idProperty],"' already exists."].join(""));this.setItem(e[a.options.idProperty],d)}else g.push(d);td=!1;var j=this.items.length;if(g.length){this.items.length&&A&&A.length&&a.hideOverlay(),!a.options.addRow||!(f&&f>this.items.length||null===f||void 0===f)||"__addRow"in g[0]||(f=this.items.length-1),null!==f&&void 0!==f?(Array.prototype.splice.apply(this.items,[f,0].concat(g)),P(f>0?f-1:0)):(Array.prototype.push.apply(this.items,g),P(j>0?j-1:0));for(h=0,i=g.length;i>h;h++)Uc.modelsById[g[h][a.options.idProperty]]=g[h]}return c.silent||(f&&(y.ignoreDiffsAfter=f+g.length),c.forced?this.refresh():this.refreshDebounced()),this},this.collapseAllGroups=function(a){b(a,!0)},this.collapseGroup=function(){var a=Array.prototype.slice.call(arguments),b=a[0];1==a.length&&-1!=b.indexOf(w)?e(b.split(w).length-1,b,!0):e(a.length-1,a.join(w),!0)},this.expandAllGroups=function(a){b(a,!1)},b=function(b,c){if(null===b||void 0===b)for(var d=0,e=t.groups.length;e>d;d++)C[d]={},t.groups[d].collapsed=c;else C[b]={},t.groups[b].collapsed=c;t.refresh(),a.fetcher&&!c&&Vb()},e=function(b,c,d){C[b][c]=t.groups[b].collapsed^d,hc(),t.refresh(),a.fetcher&&!d&&Vb()},this.expandGroup=function(){var a=Array.prototype.slice.call(arguments),b=a[0];1==a.length&&-1!=b.indexOf(w)?e(b.split(w).length-1,b,!1):e(a.length-1,a.join(w),!1)},na=function(a){var b=Uc.nodes[a];if(b&&b.cellRenderQueue.length)for(var c=$(b.rowNode).children("."+n.cell).last();b.cellRenderQueue.length;){var d=b.cellRenderQueue.pop();b.cellNodesByColumnIdx[d]=c,c=c.prev(),0===c.length&&(c=$(b.rowNode[0]).children().last())}},f=function(b,c,d){var e,g,h,j,k,l,m,n,o,p=[],q={},r=c?c.level+1:0,s=t.groups[r],u=[],v=function(a,b){return b.level===a?b.value:v(a-1,b.parentGroup)},x=function(a,b,c){if(!c)return!0;var d=b.parent[a-1]===v(a-1,c);return d?1===a?!0:x(a-1,b,c.parentGroup):!1};s.rows=[];var y=function(v){var y=function(b){var d=b?b.value:g,e=new i({column_id:s.column_id,collapsed:s.collapsed,formatter:s.formatter||Na(),level:r,parentGroup:c?c:null,predef:s,sticky:null!==s.sticky&&void 0!==s.sticky?s.sticky:!0,value:d,visible:s.groupNulls===!1&&null===d||s.groupEmpty===!1&&""===d?!1:!0});return e[a.options.idProperty]="__group"+(c?c[a.options.idProperty]+w:"")+d,b&&(e.count=b.count),t.groups[r].rows.push(e),e};if(v){if(void 0===v[r])throw new Error("Unable to group rows because the data returned from your remote fetchGroups method is missing a definition for `"+s.column_id+"` column at array position `"+r+"`.");for(var z,A=0,B=v[r].groups.length;B>A;A++)z=v[r].groups[A],x(r,z,c)&&(e=y(z),p.push(e),q[e.value]=e)}if(bd)for(var C,D=0,E=t.groups[r].groups.length;E>D;D++)C=t.groups[r].groups[D],x(r,C,c)&&(e=y(C),p.push(e),q[e.value]=e);for(l=0,m=b.length;m>l;l++)if(h=b[l],h._aggregateRow&&"__gridAggregate"==h.id)n=h;else if(h.__addRow)o=h;else{if(h.__placeholder){for(var F=0,G=p.length;G>F;F++)if(p[F].count>p[F].grouprows.length){g=p[F].value;break}}else g="function"==typeof s.getter?s.getter(h):h[s.getter];e=q[g],e||(e=y(),p.push(e),q[g]=e),e.grouprows.push(h),a.fetcher||e.count++}for(j=0,k=p.length;k>j;j++)if(p[j].predef.dataExtractor&&p[j].predef.dataExtractor){p[j].data={};for(var H=0,I=a.options.columns.length;I>H;H++)p[j].data[a.options.columns[H].field]=p[j].predef.dataExtractor(p[j],a.options.columns[H])}if(r<t.groups.length-1){var J=function(a){e.groups=a};for(l=0,m=p.length;m>l;l++)j=p[l],e=j,j._aggregateRow||f(j.grouprows,j,J)}v||p.sort(t.groups[r].comparator.bind(a)),u.length&&(p=p.concat(u)),o&&p.push(o),n&&p.push(n),d(p)};a.fetcher?Xb(function(a){y(a)}):y()},g=function(b,c){c=c||0;for(var d,e=t.groups[c],f=C[c],h=b.length,i=function(a){return a._aggregateRow};h--;)d=b[h],d.collapsed=e.collapsed^f[d.id],d.title=d.value,d.visible||(d.collapsed=0),d.groups&&(g(d.groups,c+1),a.options.nestedAggregators?d.grouprows=d.grouprows.filter(i):d.grouprows=[])},h=function(b,c){c=c||0;for(var d,e,f=[],g=0,i=0,j=b.length;j>i;i++)if(e=b[i],f[g++]=e,!e.collapsed){if(d=e.groups?h(e.groups,c+1):e.grouprows,!d)continue;for(var k=0,l=d.length;l>k;k++)f[g++]=d[k];a.options.nestedAggregators&&e.groups&&1===e.grouprows.length&&e.grouprows[0]._aggregateRow&&(f[g++]=e.grouprows[0])}return f},k=function(b){if(t.filter&&!a.fetcher){var c=r,d=s;y.isFilterNarrowing?v=c(v):y.isFilterExpanding?v=d(b,u):y.isFilterUnchanged||(v=c(b))}else v=b.concat();return{totalRows:v.length,rows:v}},this.get=function(b){if(null===b)return void 0;var c=b;if("object"==typeof b&&(c=b[a.options.idProperty]||b.data&&b.data[a.options.idProperty],null===c||void 0===c))return null;var d=Uc.modelsById[c],e=this.items.indexOf(d);return d&&d.id===b.id&&0>e&&(d=null,delete Uc.modelsById[c]),d?[e,d]:null},l=function(b,c){var d,e,f,g=[],h=0,i=c.length;y&&y.ignoreDiffsBefore&&(h=Math.max(0,Math.min(c.length,y.ignoreDiffsBefore))),y&&y.ignoreDiffsAfter&&(i=Math.min(c.length,Math.max(0,y.ignoreDiffsAfter)));for(var j=h,k=b.length;i>j;j++)j>=k?g[g.length]=j:(d=c[j],e=b[j],f=d&&d.__nonDataRow||e&&e.__nonDataRow,d&&e&&(d._groupRow&&!e._groupRow||!d._groupRow&&e._groupRow||t.groups.length&&f&&d&&d._groupRow&&d[a.options.idProperty]!=e[a.options.idProperty]||d&&d._groupRow&&d.collapsed!=e.collapsed||d&&d._groupRow&&d.count!=e.count||d&&d._groupRow&&0===d.grouprows.length&&d.groups&&d.groups.length>0||e&&e._groupRow&&0===e.grouprows.length&&e.groups&&e.groups.length>0||d&&d._groupRow&&d.grouprows.length&&e.grouprows.length&&d.grouprows[0]!=e.grouprows[0]||f&&(d._aggregateRow||e._aggregateRow)||d&&d[a.options.idProperty]!=e[a.options.idProperty]||E&&E[d[a.options.idProperty]])&&(g[g.length]=j));return g},m=function(b,c){var d,e,f,g;for(d=0,e=b.length;e>d;d++){if(g=b[d],void 0===g[a.options.idProperty]||null===g[a.options.idProperty])throw new Error("Each data item must have a unique '"+a.options.idProperty+"' key. The following item is missing an '"+a.options.idProperty+"': "+JSON.stringify(g));if(c&&(Uc.modelsById[g[a.options.idProperty]]=g),g.rows)for(var h in g.rows){if(f=g.rows[h],!Nc&&(void 0!==f.height&&null!==f.height&&f.height!=a.options.rowHeight||void 0!==f.rowSpacing&&null!==f.rowSpacing&&f.rowSpacing!=a.options.rowSpacing)){Nc=!0;break}if(c&&(Uc.modelsById[f[a.options.idProperty]]=f),f.columns&&!Yc)for(var i in f.columns){if(Yc)break;f.columns[i].postprocess&&(Yc=!0)}}if(!Nc&&(void 0!==g.height&&null!==g.height&&g.height!==a.options.rowHeight||void 0!==g.rowSpacing&&null!==g.rowSpacing&&g.rowSpacing!==a.options.rowHeight)&&(Nc=!0),g.columns&&!Yc)for(var j in g.columns){if(Yc)break;g.columns[j].postprocess&&(Yc=!0)}}return b},o=function(){var b,c,e,f,g,h,i,k=v;for(c=0,e=k.length;e>c;c++)if(b=k[c],!(b instanceof j))for(h in Uc.aggregatorsByColumnId){f=null;for(i in Uc.aggregatorsByColumnId[h])Uc.aggregatorsByColumnId[h][i].active&&(null===f?f=Uc.aggregatorsByColumnId[h][i]:Uc.aggregatorsByColumnId[h][i].active=!1);if(g=Object.keys(Uc.aggregatorsByColumnId[h]),null===f&&g.length&&(f=Uc.aggregatorsByColumnId[h][g[0]],f.active=!0),null!==f&&!f._processed){if("function"!=typeof f.process)throw new Error('The column aggregator for "'+h+"\" is missing a valid 'process' function.");f.process(b)}}for(h in Uc.aggregatorsByColumnId)for(i in Uc.aggregatorsByColumnId[h])Uc.aggregatorsByColumnId[h].active&&(Uc.aggregatorsByColumnId[h]._processed=!0);var l=new d(Uc.aggregatorsByColumnId);l[a.options.idProperty]="__gridAggregate",k.push(l)},p=function(b){var c,e,f,g,h,i,k,l,m;for(c=0,e=b.length;e>c;c++)if(f=b[c],f._groupRow){f.aggregators={};for(i in Uc.aggregatorsByColumnId){h=Ca(i),f.aggregators[i]={};for(m in Uc.aggregatorsByColumnId[i])f.aggregators[i][m]=new h.aggregators[m].fn(h),"function"==typeof f.aggregators[i][m].reset&&f.aggregators[i][m].reset(),Uc.aggregatorsByColumnId[i][m].active&&(f.aggregators[i][m].active=!0)}for(k=0,l=b[c].grouprows.length;l>k;k++)if(g=b[c].grouprows[k],!(g instanceof j))for(i in f.aggregators)for(m in f.aggregators[i])f.aggregators[i][m].process(g);var n=new d(f.aggregators);n[a.options.idProperty]="__gridAggregate-group-"+f.id,f.grouprows.push(n),f.groups&&f.groups.length&&p(f.groups)}},q=function(a,b){z=null,(y.isFilterNarrowing!=x.isFilterNarrowing||y.isFilterExpanding!=x.isFilterExpanding)&&(u=[]);var c=k(a);D=c.totalRows;var d=c.rows;Object.keys(Uc.aggregatorsByColumnId).length&&o();var e=function(a,b){for(var c in a.rows)a.rows[c].collapsed||(a.rows[c].parent=a,b.push(a.rows[c]),a.rows[c].rows&&e(a.rows[c],b))},i=function(){for(var a=[],c=0,f=d.length;f>c;c++)d[c].visible!==!1&&(a.push(d[c]),d[c].rows&&e(d[c],a));var g=l(Uc.rows,a);Uc.rows=a,g.length&&P(0),b(g)},j=[];t.groups.length&&(t.items.length||bd)?f(d,null,function(a){j=a,j.length&&(Object.keys(Uc.aggregatorsByColumnId).length&&p(j),g(j),d=h(j)),i()}):i()},this.refresh=function(){if(!td&&!a.destroyed){var b,c=Uc.rows.length;a.trigger("beforeDobyRefresh"),q(this.items,function(d){b=d,E=null,x=y,y={},this.length=Uc.rows.length,c!=Uc.rows.length&&Jc(),b.length>0&&(Ab(b),ac()),0===this.length?!a.fetcher&&a.options.emptyNotice&&wb():a.hideOverlay()}.bind(this)),gd&&a.options.autoHeight&&a.resize(),a.trigger("dobyRefresh")}},this.refreshDebounced=_.debounce(this.refresh,10),this.remove=function(b){if(void 0===b||null===b)throw new Error("Unable to delete collection item. Invalid '"+a.options.idProperty+"' supplied ("+b+").");var c=Uc.indexById[b];if(null===c||void 0===c)throw new Error(["Unable to remove row '",b,"' because no such row could be found in the grid."].join(""));this.items instanceof Backbone.Collection?this.items.remove(b):this.items.splice(this.get(b)[0],1),delete Uc.indexById[b],delete Uc.rowPositions[c],delete Uc.modelsById[b],P(c),this.refresh()},this.reset=function(a,b){a||(a=[]),td=!0,b&&(Uc.rows=[]),Uc.postprocess={},a instanceof Backbone.Collection&&(a=a.models.concat()),m(a,!0),this.items=v=a,b&&P(),td=!1,this.refresh()},this.setGrouping=function(b,c){if(!a.options.groupable)throw new Error('Cannot execute "setGrouping" because "options.groupable" is disabled.');if(b=b||[],!$.isArray(b))throw new Error("Unable to set grouping because given options are not an array. Given: "+JSON.stringify(b));b.length||(C=[]);var d=a.fetcher?Sb():!0;Uc.remoteGroups=null;var e,f,g,h=[];for(e=0,f=b.length;f>e;e++){if(void 0===b[e]||null===b[e])throw new Error("Invalid grouping value defined. Make sure your setGrouping options do not contain null or undefined values.");if(g=Ca(b[e].column_id),!c&&void 0===g)throw new Error('Cannot add grouping for column "'+b[e].column_id+'" because no such column could be found.');if(!c&&g.groupable===!1)throw new Error('Cannot add grouping for column "'+g.id+'" because "options.groupable" is disabled for that column.');if(c&&!b[e].getter)throw new Error("Cannot add custom grouping: a getter function must be provided for each grouping option");if(c&&!b[e].formatter)throw new Error("Cannot add custom grouping: a formatter function must be provided for each grouping option");!Nc&&(void 0!==b[e].height&&null!==b[e].height||void 0!==b[e].rowSpacing&&null!==b[e].rowSpacing)&&(Nc=!0),C[e]||(C[e]={}),h.push(ia(b[e],c))}var i=h.length!==this.groups.length;if(!i)for(e=0,f=h.length;f>e;e++)if(h[e].column_id!==this.groups[e].column_id){i=!0;break}hc(),this.groups=h,a.sorting=Mb(a.sorting),!d&&a.fetcher&&(this.length=this.remote_length,ta()),Nc&&yb(),a.fetcher&&!d&&i?Yb():this.refresh(),Nc&&ic(!0),!a.fetcher||d||0!==h.length&&!a.options.fetchCollapsed||Vb(),a.trigger("statechange",this._event,{})},this.setItem=function(b,c){var d=Uc.indexById[b],e=this.get(b);if(void 0===d&&null===e)throw new Error("Unable to update item ("+a.options.idProperty+": "+b+"). Invalid or non-matching id");if(a.options.data instanceof Backbone.Collection){if(!(c instanceof Backbone.Model))throw new Error("Sorry, Backbone.Collection data sets must be given a valid Backbone.Model in the setItem() method.");if(c[a.options.idProperty]!==b&&!e[1].__placeholder)throw new Error("Sorry, but Backbone does not support changing a model's id value, and as a result, this is not supported in Doby Grid either.")}if(Uc.postprocess[b]&&(delete Uc.postprocess[b],e[1].rows))for(var f in e[1].rows)Uc.postprocess[e[1].rows[f][a.options.idProperty]]&&delete Uc.postprocess[e[1].rows[f][a.options.idProperty]];if(Uc.rows[d]=c,b!==c[a.options.idProperty]&&(delete Uc.indexById[b],delete Uc.modelsById[b]),Uc.indexById[c[a.options.idProperty]]=d,Uc.modelsById[c[a.options.idProperty]]=c,(void 0===c[a.options.idProperty]||null===c[a.options.idProperty])&&(c[a.options.idProperty]=b),m([c]),this.items[e[0]]=c,c.rows){var g=_.chain(c.rows).map(function(c){return Uc.modelsById[b]=c,Uc.indexById[c[a.options.idProperty]]}).compact().value();g.length&&Ab(g)}E||(E={}),E[b]=!0,b!==c[a.options.idProperty]&&(E[c[a.options.idProperty]]=!0),this.refreshDebounced()},this.sort=function(a,b){B=b,c=a,b===!1&&this.items.reverse(),this.items.sort(a),b===!1&&this.items.reverse(),P(null,!0),this.refreshDebounced()},r=function(a){for(var b=[],c=0,d=0,e=a.length;e>d;d++)(a[d].__nonDataRow||t.filter(a[d]))&&(b[c++]=a[d]);return b},s=function(a,b){for(var c,d=[],e=0,f=0,g=a.length;g>f;f++)c=a[f],b[f]?d[e++]=c:(a[f].__nonDataRow||t.filter(c))&&(d[e++]=c,b[f]=!0);return d},this.initialize()},ja=function(a,b){if(Sc.selection){Sc.trigger("beforeselection",Sc._event,{deselecting:!0});for(var c=void 0!==a&&null!==a,d=c&&void 0!==b&&null!==b,e=0,f=Sc.selection.length;f>e;e++)d?Sc.selection[e].contains(a,b)&&Sc.selection[e].deselect(a,b):c?Sc.selection[e].contains(a)&&Sc.selection[e].deselect(a):Sc.selection[e].deselect();if(d||c||(Sc.selection=null),Sc.selection){var g=[];for(e=0,f=Sc.selection.length;f>e;e++)Sc.selection[e].fullyExcluded()||g.push(Sc.selection[e]);0===g.length?Sc.selection=null:Sc.selection=g}Sc.trigger("selection",Sc._event,{selection:Sc.selection,deselecting:!0})}},ka=this.deselectRow=function(a){ja(a);var b=Uc.nodes[a]?Uc.nodes[a].rowNode:null;b&&$(b).removeClass(Sc.options.selectedClass)},this.destroy=function(){if(this.destroyed)return void console.warn("Doby Grid instance has already been destroyed. You do not need to manually call destroy().");this.destroyed=!0,this.stopListening(),this.options.reorderable&&this.options.showHeader&&r.filter(":ui-sortable").sortable("destroy"),this.dropdown&&(this.dropdown.hide(),this.dropdown=null),this.$el&&this.$el.length&&(this.$el.off(),this.$el.remove(),q(this.$el[0])),this.$el=null,$(document.body).off("click contextmenu",hb),Zb(),this.options.showHeader&&r&&r.length&&(r.off(),q(r[0])),r=null,$(window).off("resize",rb);for(var a=[ad,_c,pd],b=0,c=a.length;c>b;b++)a[b]&&(clearTimeout(a[b]),a[b]=null);var d=function(){q(this)};for(var e in Uc.nodes)Uc.nodes[e].rowNode.each(d);this.collection.items=null,this.options.data=null,Uc=null,$("#"+n.garbage).remove(),this.trigger("destroy",this._event)},la=function(a){a&&a.jquery&&a.attr("unselectable","on").css("MozUserSelect","none").on("selectstart.ui",function(){return!1})},this.editActiveCell=function(a){Hb(a)},ma=function(a){for(var b,c=0,d=a.length;d>c;c++)b=a[c]=$.extend(JSON.parse(JSON.stringify(xd)),a[c]),b.minWidth&&b.width<b.minWidth&&(b.width=b.minWidth),b.maxWidth&&b.width>b.maxWidth&&(b.width=b.maxWidth);return a},oa=function(a){var b=a.sortCols;return!Sc.fetcher||Sb()&&!Sc.options.forceRemoteSort?void Sc.collection.sort(function(a,c){var d,e,f,g,h,i;if(a._aggregateRow)return 1;if(c._aggregateRow)return-1;for(var j=0,k=b.length;k>j;j++)if(d=b[j].sortCol,e=d.field,f=b[j].sortAsc?1:-1,g=Ja(a,d),h=Ja(c,d),"function"==typeof d.comparator){if(i=d.comparator(g,h,a,c)*f,0!==i)return i}else{if(Sc.options.keepNullsAtBottom){if(null===g&&null===h)continue;if(null===g)return 1;if(null===h)return-1}if(i=p(g,h)*f,0!==i)return i}return 0}):(Sc.collection.length=Sc.collection.remote_length,"infinite"===Sc.options.paginationStyle?Sc.options.data.reset([]):ta(),Sc.collection.refresh(),void(Sc.collection.groups.length?Yb():Vb()))},this["export"]=function(a,b,c){var d=["csv","html"];if(d.indexOf(a)<0)throw new Error('Sorry, "'+a+'" is not a supported format for export.');b=b||function(){};var e=function(){var d,e,f,g,h,i,k=[];"html"===a&&k.push("<table><thead><tr>");var l=[];for(d=0,e=Uc.activeColumns.length;e>d;d++)i=Uc.activeColumns[d].name||"","csv"===a?(i=i.replace(/\"/g,'"'),l.push(['"',i,'"'].join(""))):"html"===a&&(l.push("<th>"),l.push(i),l.push("</th>"));"csv"===a?k.push(l.join(",")):"html"===a&&(k.push(l.join("")),k.push("</tr></thead><tbody>"));var m="undefined"!=typeof c?Oa(c):null,n=m?m.grouprows:this.collection.items;for(d=0,e=n.length;e>d;d++)if(!(n[d]instanceof j)){for(f=[],"html"===a&&f.push("<tr>"),g=0,h=Uc.activeColumns.length;h>g;g++)i=this.getValueFromItem(n[d],Uc.activeColumns[g]),"csv"===a?(i=null!==i&&void 0!==i?i.toString().replace(/\"/g,'"'):"",f.push(['"',i,'"'].join(""))):"html"===a&&(f.push("<td>"),f.push(i),f.push("</td>"));"csv"===a?k.push(f.join(",")):"html"===a&&(f.push("</tr>"),k.push(f.join("")))}"html"===a&&k.push("</tbody></table>"),"csv"===a?k=k.join("\n"):"html"===a&&(k=k.join("")),b(k)}.bind(this),f=this.fetcher&&!Sb()?confirm("Are you sure you want to export all data? This will require a full data fetch on the server."):!0;return f&&(this.fetcher?this.remoteFetchAll(function(){e()}):e()),this},this.filter=function(a){if(null===a||void 0===a)this.collection.filterset=null,this.collection.filter=null;else if($.isArray(a)&&(this.collection.filterset=a),"function"==typeof a||this.fetcher)this.collection.filter=a;else{if(!$.isArray(a))throw new Error("Cannot apply filter to grid because given filter must be an array or a function, but given "+typeof a+".");this.collection.filter=function(b){for(var c,d,e,f,g=!0,h=0,i=a.length;i>h;h++){if(c=a[h],3!==c.length)throw new Error("Cannot apply filter because the give filter set contains an invalid filter item: "+JSON.stringify(c)+".");if(d=Ca(c[0]),!d)throw new Error('Unable to filter by "'+c[0]+'" because no such columns exists in the grid.');switch(e=Ja(b,d),c[1].toString().toLowerCase()){case"=":g=e==c[2];break;case"!=":g=e!==c[2];break;case"in":if(!$.isArray(c[2]))throw new Error('The "IN" filter operator must be used with an array. '+c[2]+" was given instead.");g=c[2].indexOf(e)>=0;break;case">":f=null===e?void 0:e,g=f>c[2];break;case"<":f=null===e?void 0:e,g=f<c[2];break;case">=":f=null===e?void 0:e,g=f>=c[2];break;case"<=":f=null===e?void 0:e,g=f<=c[2];break;case"~":f=null===e?"":e,g=-1!==f.toString().search(c[2].toString());break;case"!~":f=null===e?"":e,g=-1===f.toString().search(c[2].toString());break;case"~*":f=null===e?"":e,g=-1!==f.toString().toLowerCase().search(c[2].toString().toLowerCase());break;case"!~*":f=null===e?"":e,g=-1===f.toString().toLowerCase().search(c[2].toString().toLowerCase());break;default:throw new Error('Unable to filter by "'+c[0]+'" because "'+c[1]+'" is not a valid operator.')}if(!g)break}return g},Sc.trigger("statechange",this._event)}return this.fetcher?gd&&this.refetch():(hc(),this.collection.refresh()),this},pa=function(a){for(var b=0;b<Uc.activeColumns.length;){if(R(a,b))return b;b+=Ia(a,b)}return null},qa=function(a){for(var b=0,c=null;b<Uc.activeColumns.length;)R(a,b)&&(c=b),b+=Ia(a,b);return c},ra=function(a,b){if(gd){var c=a.width,d=Uc.columnsById[a.id];a._headerWidth=b&&b[d]?b[d]:Fa(d);var e,f=Math.max(a.width,a._headerWidth);if(c!=f){Fb(d);var g=f-c;e=Uc.columnPosRight[d],Rb(d,e);var h=Math.min(Jb,Math.max(Kb,e+g))-e;jc(d,h)}}},sa=function(a){if(gd){for(var b=Ga(),c=0,d=Uc.activeColumns.length;d>c;c++)ra(Uc.activeColumns[c],b);K(),Dc(a)}},ta=function(){Sc.collection.items=[],Sc.options.data instanceof Backbone.Collection&&Sc.options.data.reset(null,{silent:!0});var a,b,c,d;for(c=0,d=Sc.collection.length;d>c;c++)a="placeholder-"+c,b=new k,b[Sc.options.idProperty]=a,Sc.collection.items.push(b),Uc.modelsById[a]=b;if(Sc.collection.groups.length)for(c=0,d=Sc.collection.groups.length;d>c;c++)for(var e=0,f=Sc.collection.groups[c].rows.length;f>e;e++)Sc.collection.groups[c].rows[e].grouprows=[]},this.get=function(a){var b=this.collection.get(a);return b&&(b=b[1]),b},this.getIndex=function(a){return Uc&&Uc.indexById[a]},Wa=function(){var a=0;for(var b in Uc.nodes)a+=$(Uc.nodes[b].rowNode).outerHeight();return a},ua=function(){return Sc.active&&Sc.active.node?{row:Sc.active.row,cell:Sc.active.cell}:null},this.getActiveColumns=function(){return Uc.activeColumns},va=function(){window.maxSupportedCssHeight=window.maxSupportedCssHeight||Ra(),window.scrollbarDimensions=window.scrollbarDimensions||Va()},this.getCache=function(){return Uc},wa=function(){var a,b,c,d=Rc-(Qc?window.scrollbarDimensions.width:0);for(T=U=0,b=0,c=Uc.activeColumns.length;c>b;b++)a=Uc.activeColumns[b].width-Sc.options.columnSpacing+2,Sc.options.frozenColumns>-1&&b>Sc.options.frozenColumns?U+=a:T+=a;var e=T+U,f=Sc.options.fullWidthRows?Math.max(e,d):e+2*c;return Sc.options.fullWidthRows&&(Sc.options.frozenColumns>-1?U=f-T:T=f),"left"==Sc.options.scrollbarPosition&&f--,f},ya=function(a){var b=/l\d+/.exec(a.className);if(!b)throw new Error("getCellFromNode: cannot get cell - "+a.className);return parseInt(b[0].substr(1,b[0].length-1),10)},za=function(a,b){for(var c=Ua(b),d=0,e=0,f=0,g=Uc.activeColumns.length;g>f&&a>e;f++)e+=Uc.activeColumns[f].width,d++;return 0>d&&(d=0),{cell:d-1,row:c}},Aa=function(a,b){if(Uc.nodes[a]){na(a);var c=b;if(!Uc.nodes[a].cellColSpans[b])for(var d=0,e=b;e>=d;d++)Uc.nodes[a].cellColSpans[d]&&Uc.nodes[a].cellColSpans[d]>1&&(c-=Uc.nodes[a].cellColSpans[d]-1);c=0>c?0:c;var f=Uc.nodes[a].cellNodesByColumnIdx[c];return f&&Uc.nodes[a].cellNodesByColumnIdx[c][0]}return null},Ba=function(a,b){if(!V(a,b))return null;var c,d;if(Nc){var e=Uc.rowPositions[a];c=e.top-1,d=c+(null!==e.height&&void 0!==e.height?e.height:Sc.options.rowHeight)+2}else c=(Sc.options.rowHeight+Sc.options.rowSpacing)*a-jd+a-1,d=c+Sc.options.rowHeight+2+Sc.options.rowSpacing;for(var f=-1,g=0;b>g;g++)(-1===Sc.options.frozenColumns||g>Sc.options.frozenColumns)&&(f+=Uc.activeColumns[g].width+1);var h=f+Uc.activeColumns[b].width+2;return{bottom:d,left:f,right:h,top:c}},xa=function(a){var c=$(a.target).closest("."+n.cell,b);if(!c.length)return null;var d=Ta(c[0].parentNode),e=ya(c[0]);return null===d||null===e?null:{row:d,cell:e}},Ia=function(a,b){var c=Sc.getRowFromIndex(a);if(!c.columns)return 1;var d=c.columns[Uc.activeColumns[b].id]||c.columns[b],e=d&&d.colspan;return e="*"===e?Uc.activeColumns.length-b:e||1},Ca=function(a){return _.findWhere(Sc.options.columns,{id:a})},Da=function(a){if(!Bc){var b,c,d=document.styleSheets;for(b=0,c=d.length;c>b;b++)if((d[b].ownerNode||d[b].owningElement)==C[0]){Bc=d[b];break}if(!Bc)throw new Error("Cannot find stylesheet.");ca=[],da=[];var e,f,g=Bc.cssRules||Bc.rules;for(b=0;b<g.length;b++){var h=g[b].selectorText;e=new RegExp(/\.l\d+/).exec(h),e?(f=parseInt(e[0].substr(2,e[0].length-2),10),ca[f]=g[b]):(e=new RegExp(/\.r\d+/).exec(h),e&&(f=parseInt(e[0].substr(2,e[0].length-2),10),da[f]=g[b]))}}return{left:ca[a],right:da[a]}},Ea=function(a){if(Sc.options.showHeader){var b=[];b.push(Fa(a));var c,d="r"+a;for(var e in Uc.nodes)if(!(Uc.rows[e].columns&&Uc.rows[e].columns[a]&&Uc.rows[e].columns[a].colspan&&1!==Uc.rows[e].columns[a].colspan)&&(c=$(Uc.nodes[e].cellNodesByColumnIdx[a]),0===c.length&&(c=$(Uc.nodes[e].rowNode).children(".l"+a)),0!==c.length)){c.removeClass(d);var f=c.outerWidth();b.indexOf(f)<0&&b.push(f),c.addClass(d)}return Math.max.apply(null,b)}},Fa=function(a){if(Sc.options.showHeader){var b=r.children(),c=Uc.activeColumns[a],d=$(b[a]),e=d.width(),f=parseInt(d.css("paddingLeft"),10)+parseInt(d.css("paddingRight"),10),g=d.children("."+n.columnname+":first");g.css("overflow","visible"),d.width("auto");var h=d.width()+f+1;if(tb(c.id)){var i=d.find("."+n.sortindicator);h+=i.width()}return g.css("overflow",""),d.width(e),h}},Ga=function(){for(var a=[],b=[],c=[],d=[],e=[],f=r.children(),g=0,h=Uc.activeColumns.length;h>g;g++)c[g]=$(f[g]),d[g]=parseInt(c[g].css("paddingLeft"),10)+parseInt(c[g].css("paddingRight"),10),b[g]=c[g].width();for(g=0,h=Uc.activeColumns.length;h>g;g++)e[g]=c[g].children("."+n.columnname+":first"),e[g].css("overflow","visible"),c[g].width("auto");for(g=0,h=Uc.activeColumns.length;h>g;g++){a[g]=c[g].width()+d[g]+1;var i=Uc.activeColumns[g];if(tb(i.id)){var j=c[g].find("."+n.sortindicator);a[g]+=j.width()}}for(g=0,h=Uc.activeColumns.length;h>g;g++)e[g].css("overflow",""),c[g].width(b[g]);return a},Ha=function(a){var b=$(a.target).closest("."+n.headercolumn+":not(."+n.placeholder+")");if(!b.length){var c=xa(a);return c?Uc.activeColumns[c.cell]:null}var d=b&&b.length?b.attr("id").replace(vd,""):null;return d?Ca(d):null},Ja=function(a,b){return b.dataExtractor?b.dataExtractor(a,b):Sc.options.dataExtractor?Sc.options.dataExtractor(a,b):a instanceof Backbone.Model?a.get(b.field):a._groupRow?a.predef.dataExtractor?a.predef.dataExtractor(a,b):a.value:a.data?a.data[b.field]:null},Ka=function(){return Sc.collection?Sc.collection.length:0},La=function(a,b){var c=Uc.activeColumns[b],d=Sc.getRowFromIndex(a),e=d.columns;return e&&e[c.id]&&void 0!==e[c.id].editor?e[c.id].editor:e&&e[b]&&void 0!==e[b].editor?e[b].editor:c.editor||Sc.options.editor||f.bind(null,Sc)},Ma=function(a,b){var c=a.columns&&(a.columns[b.id]||a.columns[Uc.columnsById[b.id]]),d=a.formatter?a.formatter.bind(a):c&&c.formatter||b.formatter||Sc.options.formatter||g;return d.bind(Sc)},Na=function(){return function(a,b,c,d,e){if("*"!==e.columns[0].colspan)return c;var f=Ca(e.column_id),g=15*e.level,h=["<strong>"+f.name+":</strong> ",null===e.value?"-empty-":e.value,' <span class="count">(<strong>'+e.count+"</strong> item"];return 1!==e.count&&h.push("s"),h.push(")</span>"),[g?'<span style="margin-left:'+g+'px">':"",'<span class="icon"></span>','<span class="'+n.grouptitle+'">',h.join(""),"</span>",g?"</span>":""].join("")}},Oa=function(a){var b=null,c=Uc.rows[a];if(0===Sc.collection.groups.length)return b;var d=function(a){for(var e,f,g=0,h=a.length;h>g&&!b;g++){if(e=a[g],e==c){b=e;break}if(e.grouprows)for(var i=0,j=e.grouprows.length;j>i;i++)if(f=e.grouprows[i],f==c){b=e;break}e.groups&&d(e.groups)}};return d(Sc.collection.groups[0].rows),b},Pa=function(){for(var a=0,b=0,c=Uc.activeColumns.length;c>b;b++)a+=Uc.activeColumns[b].width+1;return a+=window.scrollbarDimensions.width,Math.max(a,Rc)+1e3},Qa=function(a,b){b=b||{};for(var c=Sc.options.locale,d=a.split("."),e=0,f=d.length;f>e;e++)c=c[d[e]];if(!c)throw new Error('Doby Grid does not have a locale string defined for "'+a+'"');return _.template(c,{interpolate:/\{\{(.+?)\}\}/gim})(b)},Ra=function(){for(var a,b=1e6,c=navigator.userAgent.toLowerCase().match(/firefox/)?6e6:1e9,d=$('<div style="display:none"></div>').appendTo(document.body);;){if(a=2*b,d.css("height",a),a>c||d.height()!==a)break;b=a}return q(d[0]),b},Sa=this.getRenderedRange=function(a,b){var c,d=$a(a,b),e=3;return c=Nc?Math.round(Ua(Oc)):Math.round(Oc/(Sc.options.rowHeight+Sc.options.rowSpacing)),-1==wd?(d.top-=c,d.bottom+=e):1==wd?(d.top-=e,d.bottom+=c):(d.top-=e,d.bottom+=e),d.top=Math.max(0,d.top),d.bottom=Math.min(Ka()-1,d.bottom),d.leftPx-=Rc,d.rightPx+=Rc,d.leftPx=Math.max(0,d.leftPx),d.rightPx=Math.min(S,d.rightPx),d},this.getRowFromEvent=function(a){var c=$(a.target).closest("."+n.row,b);return c.length?Uc.rows[Ta(c[0])]:null},this.getRowFromIndex=function(a){return Uc.rows[a]},Ta=function(a){for(var b in Uc.nodes)if(Uc.nodes[b].rowNode.is(a))return 0|b;return null},Ua=function(a){if(!Nc)return Math.floor((a+jd)/(Sc.options.rowHeight+1+Sc.options.rowSpacing));var b,c,d,e=0,f=Uc.rows.length;if(f){for(d=0;f>d;d++)if(b=Uc.rowPositions[d],b.top-b.spacing<=a&&b.bottom>=a){e=d;break}return c=Uc.rowPositions[f-1],a>c.bottom&&(e=f-1),e}},Va=function(){var a="position:absolute;top:-10000px;left:-10000px;width:100px;height:100px;overflow:scroll",b=$("<div style='"+a+"'></div>").appendTo($(document.body)),c={width:b.width()-b[0].clientWidth,height:b.height()-b[0].clientHeight};return q(b[0]),c},this.getSelectedRows=function(){var a=[];if(this.selection)for(var b=0,c=this.selection.length;c>b;b++){var d=this.selection[b].toRows();for(var e in d)a.push(d[e])}return a},this.getState=function(a){
a=a||{};var b,c,d,e,f,g={autoColumnWidth:this.options.autoColumnWidth,columns:[],filters:[],grouping:[],sort:[],resizedRows:[]};for(b=0,c=Uc.activeColumns.length;c>b;b++)if(d=Uc.activeColumns[b],d.visible){var h={id:d.id,width:d.width};if(a.column_properties)for(var i=0,j=a.column_properties.length;j>i;i++)void 0!==d[a.column_properties[i]]&&(h[a.column_properties[i]]=d[a.column_properties[i]]);g.columns.push(h)}if(this.collection&&this.collection.filterset&&(g.filters=this.collection.filterset),this.options.groupable&&this.collection&&this.collection.groups)for(b=0,c=this.collection.groups.length;c>b;b++)e=this.collection.groups[b],g.grouping.push({collapsed:e.collapsed,column_id:e.column_id});if(this.sorting)for(b=0,c=this.sorting.length;c>b;b++)f=this.sorting[b],f.group||g.sort.push({columnId:f.columnId,sortAsc:f.sortAsc});return this.options.resizableRows&&(g.resizedRows=Uc.rows.filter(function(a){return a.resized}).map(function(a){return{id:a[this.options.idProperty],height:a.height}},this)),g},this.getValueFromItem=function(a,b){return"function"==typeof a.exporter?a.exporter(b,a).toString():b.exporter&&"function"==typeof b.exporter?b.exporter(b,a).toString():Ja(a,b)},Xa=function(a){var b=["borderTopWidth","borderBottomWidth","paddingTop","paddingBottom"],c=0;return $.each(b,function(b,d){c+=parseFloat(a.css(d))||0}),c},Ya=function(){return Math.max(Sc.$el.height()-(Sc.options.showHeader?x.outerHeight()-Xa(x):0)-1,0)},Za=function(){return parseFloat($.css(Sc.$el[0],"width",!0))},$a=this.getVisibleRange=function(a,b){(void 0===a||null===a)&&(a=rd),(void 0===b||null===b)&&(b=qd);var c,d;return Sc.options.autoHeight?(c=0,d=Sc.collection.length-1):Nc?(c=Math.floor(Ua(a+jd)),d=Math.ceil(Ua(a+jd+Oc))):(c=Ua(a),d=Ua(a+Oc)+1),isNaN(c)&&(c=null),isNaN(d)&&(d=null),{top:c,bottom:d,leftPx:b,rightPx:b+Rc}},_a=function(a,b,c){if(gd&&R(a,b)){mc(a,b,!1);var d=Aa(a,b);sc(d,c||a===Ka()||Sc.options.autoEdit)}},ab=function(a,b,c){for(var d,e=Ka();;){if(++a>=e){if(!Sc.options.rowBasedSelection||!Sc.options.cycleRowBasedSelection)return null;a=0}for(d=b=0;c>=b;)d=b,b+=Ia(a,b);if(R(a,d))return{row:a,cell:d,posX:c}}},bb=function(a,b){if(0>=b)return null;var c=pa(a);if(null===c||c>=b)return null;for(var d,e={row:a,cell:c,posX:c};;){if(d=eb(e.row,e.cell,e.posX),!d)return null;if(d.cell>=b)return e;e=d}},cb=function(a,b,c){if(null===a&&null===b&&(a=b=c=0,R(a,b)))return{row:a,cell:b,posX:b};var d=eb(a,b,c);if(d)return d;for(var e=null,f=Ka();++a<f;)if(e=pa(a),null!==e)return{row:a,cell:e,posX:e};return null},db=function(a,b,c){if(null===a&&null===b&&(a=Ka()-1,b=c=Uc.activeColumns.length-1,R(a,b)))return{row:a,cell:b,posX:b};for(var d,e;!d&&!(d=bb(a,b,c));){if(--a<0)return null;b=0,e=qa(a),null!==e&&(d={row:a,cell:e,posX:e})}return d},eb=function(a,b){if(b>=Uc.activeColumns.length)return null;do b+=Ia(a,b);while(b<Uc.activeColumns.length&&!R(a,b));return b<Uc.activeColumns.length?{row:a,cell:b,posX:b}:null},fb=function(a,b,c){for(var d;;){if(--a<0){if(!Sc.options.rowBasedSelection||!Sc.options.cycleRowBasedSelection)return null;a=Ka()-1}for(d=b=0;c>=b;)d=b,b+=Ia(a,b);if(R(a,d))return{row:a,cell:d,posX:c}}},hb=function(a){$(a.target).hasClass("doNotCommitCurrentDobyGridEdit")||(Sc.options.editable&&Sc.currentEditor&&Sc.options.commitCurrentEditOnClick&&ea(function(){}),Sc.options.stickyFocus||$(a.target).closest(Sc.$el).length>0||Sc.dropdown&&$(a.target).closest(Sc.dropdown.$el).length>0||0===$(a.target).parent().length||Sc.destroyed||(Sc.activate(null),ja()))},ib=function(a){Sc.options.editable&&Sc.currentEditor&&Sc.options.commitCurrentEditOnClick&&ea(function(){});var b=xa(a),c=!0;if(b&&null!==b.row&&void 0!==b.row&&(null===Sc.currentEditor||!Sc.active||Sc.active.row!=b.row||Sc.active.cell!=b.cell)){var d=Sc.getRowFromIndex(b.row);if(Sc.options.collapsible&&d&&d._groupRow){var e=$(a.target).hasClass(n.grouptoggle)||$(a.target).closest("."+n.grouptoggle).length;if(e)return Sc.trigger("groupheaderclick",a,{item:d}),d.collapsed?Sc.collection.expandGroup(d[Sc.options.idProperty]):Sc.collection.collapseGroup(d[Sc.options.idProperty]),a.stopImmediatePropagation(),void a.preventDefault()}if(b&&(Sc.trigger("click",a,{cell:b.cell,column:Uc.activeColumns[b.cell],item:d,row:b.row}),!a.isImmediatePropagationStopped()&&R(b.row,b.cell))){var f=Sc.options.shiftSelect&&a.shiftKey,g=Sc.options.ctrlSelect&&(a.ctrlKey||a.metaKey);if(Sc.options.rowBasedSelection){var h=Sc.selection&&Sc.selection[Sc.selection.length-1];if(g&&(Cb(b.row)?ka(b.row):f||(c=!1,Sc.selectRows(b.row,b.row,!0))),f&&Sc.active)if(ka(Sc.active.row),g)Sc.selectRows(Sc.active.row,b.row,!0);else if(h){ja();var i=Sc.active.row==h.fromRow,j=i?h.toRow:h.fromRow;b.row<h.fromRow?Sc.selectRows(b.row,j,!0):b.row>h.toRow?Sc.selectRows(j,b.row,!0):i?Sc.selectRows(b.row,j,!0):Sc.selectRows(j,b.row,!0)}else Sc.selectRows(Sc.active.row,b.row,!0);!Sc.options.useDobySelect||g||f||(ja(),Sc.selectRows(b.row,b.row,!0)),aa()}else if(f&&Sc.active&&(ja(),Sc.selectCells(Sc.active.row,Sc.active.cell,b.row,b.cell)),g&&Sc.active)return Cb(b.row,b.cell)?void ja(b.row,b.cell):(Sc.selection||Sc.selectCells(Sc.active.row,Sc.active.cell,Sc.active.row,Sc.active.cell,!0),void Sc.selectCells(b.row,b.cell,b.row,b.cell,!0));pc(b.row,!1),c&&sc(Aa(b.row,b.cell))}}},jb=function(a){var c=$(a.target).closest("."+n.cell,b);if(0!==c.length&&(Sc.options.deactivateOnRightClick&&Sc.active&&Sc.activate(),!Sc.active||Sc.active.node!==c[0]||null===Sc.currentEditor)){var d=Ha(a),e=xa(a)||{};Sc.trigger("contextmenu",a,{cell:null!==e.cell&&void 0!==e.cell?e.cell:null,column:d,item:Sc.getRowFromIndex(e.row),row:null!==e.row&&void 0!==e.row?e.row:null})}},kb=function(a){var b=xa(a);if(b&&(null===Sc.currentEditor||!Sc.active||Sc.active.row!=b.row||Sc.active.cell!=b.cell)){var c=Ha(a);Sc.trigger("dblclick",a,{cell:null!==b.cell&&void 0!==b.cell?b.cell:null,column:c,item:Sc.getRowFromIndex(b.row),row:null!==b.row&&void 0!==b.row?b.row:null}),a.isImmediatePropagationStopped()||Sc.options.editable&&_a(b.row,b.cell,!0)}},mb=function(a){var b=Ha(a);b&&Sc.trigger("headerclick",a,{column:b})},lb=function(a){var b=Ha(a);Sc.trigger("headercontextmenu",a,{column:b})},nb=function(a){Sc.active&&Sc.trigger("keydown",a,{row:Sc.active.row,cell:Sc.active.cell});var c=a.isImmediatePropagationStopped();if(this._event=a,c||(67!=a.which||!a.ctrlKey&&!a.metaKey||a.altKey||a.shiftKey?a.shiftKey||a.altKey||a.ctrlKey?9!=a.which||!a.shiftKey||a.ctrlKey||a.altKey||(c=Sc.options.editable&&Sc.currentEditor?ea(function(a){a&&Ob("prev")}):Ob("prev")):27==a.which?Sc.options.editable&&Sc.currentEditor?(Sc.currentEditor.cancel(),Ib(),b.eq(0).focus(),c=!0):Sc.selection?ja():Sc.active&&Sc.activate():34==a.which?(oc(1),c=!0):33==a.which?(oc(-1),c=!0):36==a.which?(Sc.scrollToRow(0),c=!0):35==a.which?(Sc.scrollToRow(Sc.collection.items.length-1),c=!0):37==a.which?c=Sc.options.editable&&Sc.currentEditor?ea(function(a){a&&Ob("left")}):Ob("left"):39==a.which?c=Sc.options.editable&&Sc.currentEditor?ea(function(a){a&&Ob("right")}):Ob("right"):38==a.which?c=Sc.options.editable&&Sc.currentEditor?ea(function(a){a&&Ob("up")}):Ob("up"):40==a.which?c=Sc.options.editable&&Sc.currentEditor?ea(function(a){a&&Ob("down")}):Ob("down"):9==a.which?c=Sc.options.editable&&Sc.currentEditor?ea(function(a){a&&Ob("next")}):Ob("next"):13==a.which&&(c=Sc.options.editable&&Sc.currentEditor?ea(function(a){a&&Ob("down")}):Ob("down")):fa()),this._event=null,c){a.stopPropagation(),a.preventDefault();try{a.originalEvent.which=0}catch(d){}}},ob=function(a){Sc.active&&Sc.trigger("keydown",a,{row:Sc.active.row,cell:Sc.active.cell});var c=a.isImmediatePropagationStopped(),d=a.shiftKey,e=Sc.selection&&Sc.selection[Sc.selection.length-1],f=function(a){if(Sc.options.selectOnNavigate){var b=Sc.active&&Sc.active.row;null!==b&&"undefined"!=typeof b?(ja(),d&&e?b<e.fromRow?Sc.selectRows(b,e.toRow,!0):b>e.toRow?Sc.selectRows(e.fromRow,b,!0):a?Sc.selectRows(e.fromRow,b,!0):Sc.selectRows(b,e.toRow,!0):Sc.selectRows(b,b,!0)):(Sc.selectRows(0,0,!0),sc(Aa(0,0),!1))}};if(this._event=a,!a.altKey)switch(a.which){case 40:c=pb(function(){return d&&Sc.options.cycleRowBasedSelection&&e.toRow>=Ka()-1?!0:(Ob("down"),f(),!0)});break;case 38:c=pb(function(){return d&&Sc.options.cycleRowBasedSelection&&e.fromRow<=0?!0:(Ob("up"),f(!0),!0)});break;case 9:c=pb(function(){return d?(d=!1,Ob("up"),f(!0)):(Ob("down"),f()),!0});break;case 13:Sc.options.editable&&Sc.currentEditor&&(c=ea(function(a){a&&(Ob("down"),f())}));break;case 37:Sc.options.editable&&Sc.currentEditor||(c=pb(function(){return Ob("left")}));break;case 39:Sc.options.editable&&Sc.currentEditor||(c=pb(function(){return Ob("right")}));break;case 34:oc(1),c=!0;break;case 33:oc(-1),c=!0;break;case 36:Sc.options.editable&&Sc.currentEditor||(Sc.scrollToRow(0),c=!0);break;case 35:Sc.options.editable&&Sc.currentEditor||(Sc.scrollToRow(Sc.collection.items.length-1),c=!0);break;case 27:Sc.options.editable&&Sc.currentEditor?(Sc.currentEditor.cancel(),Ib(),b.focus(),c=!0):Sc.selection?ja():Sc.active&&Sc.activate();break;case 46:Sc.active||Sc.trigger("keydown",a)}if(this._event=null,c){a.stopPropagation(),a.preventDefault();try{a.originalEvent.which=0}catch(g){}}},pb=function(a){return Sc.options.editable&&Sc.currentEditor?ea(function(b){b&&a()}):a()},qb=function(a){void 0===a&&(a=null),rd=F[0].scrollTop,qd=E[0].scrollLeft;var b=Math.abs(rd-od),d=Math.abs(qd-nd);if(d&&(nd=qd,Sc.options.showHeader&&(Sc.options.frozenColumns>-1?x[1].scrollLeft=qd:x[0].scrollLeft=qd)),b){if(wd=rd>od?1:-1,od=rd,Sc.options.frozenColumns>-1&&(cd&&!Sc.options.frozenBottom?D.eq(2)[0].scrollTop=rd:D.eq(0)[0].scrollTop=rd),Oc>b)qc(rd+jd);else{var e=jd;kd=gb==Oc?0:Math.min(Nb-1,Math.floor(rd*((Ec-Oc)/(gb-Oc))*(1/Qb))),jd=Math.round(kd*W),e!=jd&&yb()}Ac(rd)}(d||b)&&(_c&&clearTimeout(_c),(Math.abs(id-rd)>20||Math.abs(hd-qd)>20||nc)&&(nc||Sc.options.virtualScroll&&!(Math.abs(id-rd)<Oc&&Math.abs(hd-qd)<Rc)?(Sc.options.scrollLoader&&!nc&&(nc=$('<div class="'+n.scrollloader+'">'+Sc.options.scrollLoader()+"</div>").appendTo(Sc.$el)),_c=setTimeout(function(){nc&&(nc.remove(),nc=null),ac(),_c=null},50)):ac(),Sc.trigger("viewportchanged",a,{scrollLeft:qd,scrollTop:rd,scrollLeftDelta:d,scrollTopDelta:b})),Sc.options.showGutters&&(c.css("top",rd),c.filter(".left").css("left",qd),c.filter(".right").css("right",-qd))),Sc.trigger("scroll",a,{scrollLeft:qd,scrollTop:rd,scrollLeftDelta:d,scrollTopDelta:b})},rb=function(a){a.target===window&&Sc.$el.is(":visible")&&Sc.resize()},sb=function(a){if(!a)return!1;var b=Ca(a);if(!b)return!1;var c=_.groupBy(Sc.collection.groups,function(a){return a.column_id});return c[a]&&c[a].length?c[a][0]:!1},tb=function(a){if(!a)return!1;var b=_.pluck(Sc.sorting,"columnId");return b.indexOf(a)>=0},this.hideColumn=function(a){var b=null;if(void 0!==a&&null!==a&&(b=Ca(a)),!b)throw new Error('Unable to hide column "'+a+'" because no such column could be found.');var c=this.options.columns.map(function(b){var c=_.clone(b);return c.id===a&&(c.visible=!1),c});this.setColumns(c)},this.hideOverlay=function(){return A&&A.length&&(q(A[0]),A=null),xb(),this},vb=function(){var a=new j({__addRow:!0,data:{},formatter:function(){return""},id:"-add-row-"});Sc.collection.add(a,{forced:!0})},Bb=function(a,b){var c=Ka(),d=Sc.getRowFromIndex(a);return d?d.editable===!1?!1:Uc.activeColumns[b].editable!==!1||void 0!==d.columns&&void 0!==d.columns[Uc.activeColumns[b].field]&&d.columns[Uc.activeColumns[b].field].editable===!0?c>a&&!d?!1:La(a,b)?!0:!1:!1:!1},Cb=function(a,b){if(!Sc.selection)return!1;for(var c,d=0,e=Sc.selection.length;e>d;d++)if(c=Sc.selection[d],c.contains(a,b))return!0;return!1},Db=function(a){if(!Sc.selection)return!1;for(var b,c=0,d=Sc.selection.length;d>c;c++)if(b=Sc.selection[c],b.contains(a))return!0;return!1},Eb=function(a){if(!Sc.selection)return!1;var b=Sc.collection.length-1;"__gridAggregate"==Sc.collection.items[Sc.collection.items.length-1][Sc.options.idProperty]&&b--;for(var c,d=0,e=Sc.selection.length;e>d;d++)if(c=Sc.selection[d],0===c.fromRow&&c.toRow===b&&c.fromCell>=a&&c.toCell<=a)return!0;return!1},wb=function(){var a="";a="function"==typeof Sc.options.emptyNotice?Sc.options.emptyNotice.bind(Sc)():Qa(Sc.fetcher?"empty.remote":Sc.collection&&Sc.collection.filterset?"empty.filter":"empty.default"),Sc.showOverlay({"class":n.empty,html:a})},xb=function(){Jc(),yb(),ac()},yb=function(){Sc.currentEditor&&Ib();for(var a in Uc.nodes)_b(a)},zb=this.invalidate=function(a){delete Uc.postprocess[Uc.rows[a][Sc.options.idProperty]],ld=Math.min(ld,a),md=Math.max(md,a),zc()},Ab=function(a){if(a&&a.length){wd=0;for(var b=0,c=a.length;c>b;b++)Sc.currentEditor&&Sc.active&&Sc.active.row===a[b]&&Ib(),Uc.nodes[a[b]]&&_b(a[b])}},this.isGrouped=function(){return this.collection.groups.length?!0:!1},this.isSorted=function(){return this.sorting.length?!0:!1},Gb=function(){Sc.stopListening(Sc.options.data),Sc.listenTo(Sc.options.data,"add",function(a,b,c){Sc.destroyed||(void 0!==c.silentDobyRefresh&&(c.silent=c.silentDobyRefresh),Sc.collection.add(a,c))}),Sc.listenTo(Sc.options.data,"change",function(a){Sc.destroyed||(a.changed&&a.changed[Sc.options.idProperty]?Sc.setItem(a._previousAttributes[Sc.options.idProperty],a):Sc.setItem(a[Sc.options.idProperty],a))}),Sc.listenTo(Sc.options.data,"remove",function(a){Sc.destroyed||Sc.collection.remove(a[Sc.options.idProperty])}),Sc.listenTo(Sc.options.data,"reset",function(a){Sc.destroyed||Sc.collection.reset(a)}),Sc.listenTo(Sc.options.data,"sort",_.debounce(function(){Sc.destroyed||Sc.collection&&Sc.collection.reset(Sc.options.data)}),10)},Fb=function(){var a=r.children("."+n.headercolumn);a.each(function(a){Uc.activeColumns[a].previousWidth=Uc.activeColumns[a].width})},Hb=function(a){if(Sc.active&&Sc.active.node&&Sc.options.editable===!0&&Bb(Sc.active.row,Sc.active.cell)){clearTimeout($c);var b=Uc.activeColumns[Sc.active.cell],c=Sc.getRowFromIndex(Sc.active.row);$(Sc.active.node).addClass("editable"),a||(Sc.active.node.innerHTML="");var d=a||La(Sc.active.row,Sc.active.cell);Sc.currentEditor=new d({grid:Sc,cell:Sc.active.node,column:b,item:c||{},commitChanges:function(){Sc.options.autoEdit&&Ob("down")}});for(var e=["applyValue","cancel","destroy","focus","getValue","isValueChanged","loadValue","serializeValue","setValue","validate"],f=0,g=e.length;g>f;f++)if(!Sc.currentEditor[e[f]])throw new Error("Your editor is missing a '"+[e[f]]+"' function.");rc=Sc.currentEditor.serializeValue(),Sc.currentEditor.focus()}},Ib=function(){if(Sc.currentEditor&&(Sc.currentEditor.$input.is(document.activeElement)&&b.eq(0).focus(),Sc.currentEditor.destroy(),Sc.currentEditor=null,Sc.active&&Sc.active.node)){var a=Sc.getRowFromIndex(Sc.active.row);if($(Sc.active.node).removeClass("editable invalid"),a){var c=Uc.activeColumns[Sc.active.cell],d=Ma(a,c);Sc.active.node.innerHTML=d(Sc.active.row,Sc.active.cell,Ja(a,c),c,a),zb(Sc.active.row)}}},Lb=function(){var a,c=["paddingLeft","paddingRight"],d=["paddingTop","paddingBottom"];Sc.options.showHeader&&(a=$('<div class="'+n.headercolumn+'" style="visibility:hidden">-</div>').appendTo(s),dd=ed=0,"border-box"!=a.css("box-sizing")&&"border-box"!=a.css("-moz-box-sizing")&&"border-box"!=a.css("-webkit-box-sizing")&&($.each(c,function(b,c){dd+=parseFloat(a.css(c))||0}),$.each(d,function(b,c){ed+=parseFloat(a.css(c))||0})),q(a[0]));var e=$('<div class="'+n.row+'"></div>').appendTo(b[0]);a=$('<div class="'+n.cell+'" style="visibility:hidden">-</div>').appendTo(e),Wc=Vc=0,"border-box"!=a.css("box-sizing")&&"border-box"!=a.css("-moz-box-sizing")&&"border-box"!=a.css("-webkit-box-sizing")&&($.each(c,function(b,c){Wc+=parseFloat(a.css(c))||0}),$.each(d,function(b,c){Vc+=parseFloat(a.css(c))||0})),q(e[0]),G=Math.max(dd,Wc)},Mb=function(a){var b,c,d=[],e={};for(b=0,c=Sc.collection.groups.length;c>b;b++)d.push({columnId:Sc.collection.groups[b].column_id,sortAsc:!0,group:!0}),e[Sc.collection.groups[b].column_id]=d[b];var f;for(b=0,c=a.length;c>b;b++)a[b].group||(f=e[a[b].columnId],f?(delete f.group,f.sortAsc=a[b].sortAsc):d.push(a[b]));return d},Ob=function(a){if(!Sc.options.keyboardNavigation)return!1;if(!(Sc.active&&Sc.active.node||"prev"==a||"next"==a))return!1;var b={up:-1,down:1,left:-1,right:1,prev:-1,next:1};ud=b[a];var c={up:fb,down:ab,left:bb,right:eb,prev:db,next:cb},d=c[a],e=d(Sc.active?Sc.active.row:null,Sc.active?Sc.active.cell:null,H);if(e){var f=e.row==Ka();return mc(e.row,e.cell,!f),sc(Aa(e.row,e.cell)),H=e.posX,!0}return!1},Rb=function(a,b){var c,d,e=r.children("."+n.headercolumn),f=null,g=null;if(Sc.options.autoColumnWidth)for(f=0,g=0,c=a+1;c<e.length;c++)d=Uc.activeColumns[c],d.resizable&&(null!==g&&(d.maxWidth?g+=d.maxWidth-d.previousWidth:g=null),f+=d.previousWidth-Math.max(d.minWidth||0,G));var h=0,i=0;for(c=0;a>=c;c++)d=Uc.activeColumns[c],d.resizable&&(null!==i&&(d.maxWidth?i+=d.maxWidth-d.previousWidth:i=null),h+=d.previousWidth-Math.max(d.minWidth||0,G));null===f&&(f=1e5),null===h&&(h=1e5),null===g&&(g=1e5),null===i&&(i=1e5),Jb=b+Math.min(f,i),Kb=b-Math.min(h,g)},this.refetch=function(){if(!this.fetcher)throw new Error('The "refetch" method can only be used with Doby Grid instances which use a remote data set.');return Ub(function(){Sc.collection.groups&&Sc.collection.groups.length?Yb():Vb()}),this},Sb=function(){if("infinite"===Sc.options.paginationStyle)return!1;for(var a=0,b=Sc.collection.items.length;b>a;a++)if(Sc.collection.items[a].__placeholder)return!1;return!0},Ub=function(a){var b={filters:"function"!=typeof Sc.collection.filter?Sc.collection.filter:null},c=function(){var c=new $.Deferred;if(!Sc.fetcher.count&&"infinite"!==Sc.options.paginationStyle)throw new Error("You must either specify a valid count() method in your fetcher or use a different pagination style. (see grid.options.paginationStyle)");return"infinite"===Sc.options.paginationStyle?(Jc(),Sc.collection.refresh(),void a()):(Sc.fetcher.count(b,function(b){if(Sc.destroyed)return c.resolve();if("number"!=typeof b)throw new Error("Your count() method must return a number. It returned a "+typeof b+' of value "'+b+'" instead.');Sc.collection.length=b,Sc.collection.remote_length=b,0===b?(Sc.collection.reset(),wb()):ta(),Jc(),Sc.collection.refresh(),a(),c.resolve()}),c.promise())};Sc.fetcher.queue=Sc.fetcher.queue.then(function(){return c()})},Vb=function(){var a=!0;Sc.fetcher.request&&"function"==typeof Sc.fetcher.request.abort&&(Sc.fetcher.request.abort(),a=!1),null!==pd&&clearTimeout(pd);var b=function(a){if(a.groups){if(a.groups.length)for(var c=0,d=a.groups.length;d>c;c++)if(b(a.groups[c]))return!0;return null}return a.grouprows&&a.grouprows.length?_.findWhere(a.grouprows,{__placeholder:!0})?!0:!1:null},c=function(){var c=new $.Deferred,d=$a(),e=d.top,f=d.bottom,g=f-e;-1==wd?e-=Sc.options.rowsToPrefetch:f+=Sc.options.rowsToPrefetch,0>e&&(e=0),"infinite"!==Sc.options.paginationStyle&&Sc.collection.length>0&&(f=Math.min(f,Sc.collection.length-1));var h,i,k,l,m=Sc.collection.groups.length?0:e,n=0,o=0,p=0;if(Sc.options.fetchCollapsed&&Sc.collection.groups.length)for(var q=m;f>=q;q++)l=Uc.rows[q],void 0===h&&l&&(l.__placeholder||l._groupRow&&b(l))&&(h=Math.max(q-o+p-n,0)),l&&l._groupRow&&o++,l&&l._groupRow&&!l.parentGroup&&(p+=l.count),!l||l instanceof j||n++,void 0!==h&&(i=p-1);else for(var r=m;f>=r;r++)l=Uc.rows[r],l&&l._groupRow&&l.collapsed&&void 0===h?(o++,p+=l.count):(l&&l instanceof j&&!l.__placeholder&&o++,e>r||(!l||l.__placeholder)&&(void 0===h&&(h=r-o+p),i=r-o+p));if(void 0===h)return Tb(null,null,{silent:a}),c.resolve().promise();var s;k=i-h+1,"infinite"===Sc.options.paginationStyle&&(k=Sc.options.infinitePageSize?Math.max(k,Sc.options.infinitePageSize):g+1);var t=h<=d.bottom&&d.top<=i;return Wb({columns:Uc.activeColumns,filters:"function"!=typeof Sc.collection.filter?Sc.collection.filter:null,limit:k,offset:h,order:Sc.sorting},function(a){if(Sc.destroyed)return c.resolve();if(Sc.options.data instanceof Backbone.Collection)for(var b=0,d=a.length;d>b;b++)Sc.options.data.add(a[b],{at:h+b,merge:!0,silentDobyRefresh:!0});else Sc.collection.add(a,{at:h,merge:!0,silent:!0});var e=h-p,g=i+o-p;s!==Nc&&(P(),xb()),Tb(e,g),"infinite"===Sc.options.paginationStyle&&Sc.collection.refresh(),s!==Nc&&$a().bottom>f&&Vb(),c.resolve()},function(){c.resolve()},t),c.promise()};Sc.fetcher.queue=Sc.fetcher.queue.then(function(){return c()})},this.remoteFetchAll=function(a){return a=a||function(){},this.fetcher.request&&"function"==typeof this.fetcher.request.abort&&this.fetcher.request.abort(),null!==pd&&clearTimeout(pd),Wb({columns:Uc.activeColumns,order:this.sorting},function(b){this.options.data instanceof Backbone.Collection?this.options.data.reset(b):this.collection.reset(b),a()}.bind(this)),this},Wb=function(a,b,c,d){b=b||function(){},c=c||function(){},d="undefined"!=typeof d?d:!0,a.offset||(a.offset=0),a.limit||(a.limit=null),pd&&(clearTimeout(pd),c()),pd=setTimeout(function(){try{"function"==typeof Sc.fetcher.onLoading&&Sc.fetcher.onLoading(d),Sc.fetcher.request=Sc.fetcher.fetch(a,function(a){Sc.fetcher.request=null,b(a),"function"==typeof Sc.fetcher.onLoaded&&Sc.fetcher.onLoaded(d)})}catch(c){throw new Error("Doby Grid remote fetching failed due to: "+c)}},Sc.options.remoteScrollTime)},Xb=function(a){if(a=a||function(){},Sc.fetcher.request&&"function"==typeof Sc.fetcher.request.abort&&Sc.fetcher.request.abort(),Uc.remoteGroups)a(Uc.remoteGroups);else{var b={filters:"function"!=typeof Sc.collection.filter?Sc.collection.filter:null,groups:Sc.collection.groups,order:Sc.sorting};"function"==typeof Sc.fetcher.onLoading&&Sc.fetcher.onLoading();var c=function(){var c=new $.Deferred;return Sc.fetcher.request=Sc.fetcher.fetchGroups(b,function(b){Sc.fetcher.request=null,Mc(b),Uc.remoteGroups=b,a(b),Sc.trigger("remotegroupsloaded",Sc._event,{}),"function"==typeof Sc.fetcher.onLoaded&&Sc.fetcher.onLoaded(),c.resolve()}),c.promise()};Sc.fetcher.queue=Sc.fetcher.queue.then(function(){return c()})}},Yb=function(){Uc.remoteGroups=null;var a=function(){for(var a=!0,b=0,c=Sc.collection.groups.length;c>b&&a;b++)for(var d=0,e=Sc.collection.groups[b].rows.length;e>d;d++)if(!Sc.collection.groups[b].rows[d].collapsed){a=!1;break}(!a||Sc.options.fetchCollapsed)&&Vb()};Sc.once("remotegroupsloaded",a),Sc.collection.refresh()},Tb=function(a,b,c){c=c||{};for(var d=a;b>=d;d++)Ab([d]);Jc(),ac(),c.silent||Sc.trigger("remoteloaded",Sc._event,{})},this.remove=function(a){return this.collection.remove(a),this},this.removeColumn=function(a){if(!a)return this;"object"==typeof a&&(a=a.id);var b,c=this.options.columns.filter(function(c){if(c.id==a&&(b=c,c.removable!==!0))throw new Error('Cannot remove column "'+c.id+'" because it is not removable.');return c.id!=a});if(!b)throw new Error('Cannot remove column "'+a+'" because no such column exists.');sb(a)&&this.removeGrouping(a);var d;return b&&b.quickFilterInput&&(q(b.quickFilterInput.parent()[0]),d=!0),Sc.setColumns(c),d&&I(),this},Zb=function(){C&&C.length&&(q(C[0]),C=null),Bc=null},this.removeGrouping=function(a){if(a){"object"==typeof a&&(a=a.id);var b=sb(a);return b&&(this.collection.groups.splice(this.collection.groups.indexOf(b),1),this.setGrouping(this.collection.groups)),this}},$b=function(a){for(var b=[],c=0,d=a.length;d>c;c++){var e=a[c];Sc.canCellBeSelected(e.fromRow,e.fromCell)&&Sc.canCellBeSelected(e.toRow,e.toCell)&&b.push(e)}return b},_b=function(a){var b,c=Uc.nodes[a];if(c){var d=c.rowNode.find(".doby-grid-pane-top-left .doby-grid-viewport");d.length&&d.each(function(a,b){var c=$(b);c.data("doby_scrolling",{top:c.scrollTop(),left:c.scrollLeft()})}),c.rowNode[0].parentElement.removeChild(c.rowNode[0]),c.rowNode[1]&&c.rowNode[1].parentElement.removeChild(c.rowNode[1]),delete Uc.nodes[a];var e=Uc.rows[a];if(e&&Uc.postprocess[e[Sc.options.idProperty]])for(var f in Uc.postprocess[e[Sc.options.idProperty]])b=Uc.activeColumns[Uc.columnsById[f]],e&&e.columns&&(b=_.findWhere(e.columns,{id:f})),b&&b.cache||delete Uc.postprocess[e[Sc.options.idProperty]][f]}},ac=function(){if(gd){var a=$a(),b=Sa();Z(b),hd!=qd&&X(b),Sc.$el&&(!Qc&&Sc.options.autoColumnWidth?Sc.$el.addClass(n.noright):Sc.$el.removeClass(n.noright)),Sc.trigger("beforeRenderRows"),fc(b),Sc.trigger("renderRows"),ld=a.top,md=Math.min(Ka()-1,a.bottom),zc(),id=rd,hd=qd,Ac(rd),Sc.fetcher||0!==Sc.collection.length||wb()}},bc=function(a,b,c,d,e){var f=Uc.activeColumns[c];e&&e.columns&&e.columns[c]&&(f=e.columns[c]);var g=Math.min(Uc.activeColumns.length-1,c+d-1),h=e?Ja(e,Uc.activeColumns[c]):null,i=e._groupRow?"":f["class"]?"function"==typeof f["class"]?f["class"].bind(Sc)(b,c,h,f,e):f["class"]:null,j=f,k=[n.cell,"l"+c,"r"+g];if(i&&k.push(i),Sc.active&&b===Sc.active.row&&c===Sc.active.cell&&k.push("active"),Cb(b,c)&&k.push(Sc.options.selectedClass),j.selectable===!1&&k.push(n.cellunselectable),a.push('<div class="'+k.join(" ")+'">'),f.cache&&f.postprocess&&Uc.postprocess[e[Sc.options.idProperty]]&&Uc.postprocess[e[Sc.options.idProperty]][j.id]){var l=Uc.postprocess[e[Sc.options.idProperty]][j.id];Sc.options.cacheNodes&&l instanceof $?a.push("<div class='cache_placeholder' id='cache_placeholder_"+e[Sc.options.idProperty]+"' data-column-id='"+j.id+"' data-item-id='"+e[Sc.options.idProperty]+"'></div>"):a.push(Uc.postprocess[e[Sc.options.idProperty]][j.id])}else if(e)try{a.push(Ma(e,f)(b,c,h,f,e))}catch(m){a.push(""),console.error&&console.error("Cell failed to render due to failed '"+j.id+"' column formatter. Error: "+m.message,m)}a.push("</div>"),Uc.nodes[b]&&(Uc.nodes[b].cellRenderQueue.push(c),Uc.nodes[b].cellColSpans[c]=d)},cc=function(){if(Sc.options.showHeader){r.each(function(){$(this).is(":empty")||($(this).empty(),$(this).width(Pa()))});for(var a,b,c,d,e,f=0,g=Uc.activeColumns.length;g>f;f++)b=[],a=Uc.activeColumns[f],e=Sc.options.frozenColumns>-1?f<=Sc.options.frozenColumns?s:t:s,c=[n.headercolumn,a.headerClass||""],a.sortable&&c.push(n.headersortable),d=a.width-dd,b.push('<div class="'+c.join(" ")+'" style="width:'+d+'px" '),b.push('id="'+(vd+a.id)+'"'),void 0!==a.tooltip&&null!==a.tooltip&&"title"==Sc.options.tooltipType&&b.push(' title="'+a.tooltip+'"'),b.push(">"),b.push('<span class="'+n.columnname+'">'+a.name+"</span>"),a.sortable&&Sc.options.showSortIndicator&&b.push('<span class="'+n.sortindicator+'"></span>'),b.push("</div>"),e.append(b.join(""));Cc(),Sc.options.resizableColumns&&xc(),Sc.options.reorderable&&wc()}},dc=function(a,b){for(var c,d=$(['<div class="',n.dropdownmenu,'"></div>'].join("")),e=function(a){"function"==typeof this.fn?this.fn.bind(Sc)(a):this.menu&&a.stopPropagation()},f=0,g=a.length;g>f;f++)if(c=a[f],void 0===c.enabled||c.enabled)if(c.title)d.append(['<div class="',n.dropdowntitle,'">',c.icon?c.icon:"",c.name||"","</div>"].join(""));else if(c.divider)d.append(['<div class="',n.dropdowndivider,'"></div>'].join(""));else{var h=c.name||"",i="";void 0!==c.value&&(c.value&&(i=" on"),h+=['<span class="',n.dropdownicon,'"></span>'].join(""));var j=['<div class="',n.dropdownitem," ",i,'">',c.icon?c.icon:"",h,"</div>"].join(""),k=$(j).appendTo(d);c.menu&&(k.append(['<span class="',n.dropdownarrow,'"></span>'].join("")),dc(c.menu,k)),k.click(e.bind(c))}d.appendTo(b)},ec=function(b,c,d,e){var f,g=Sc.getRowFromIndex(d),h=n.row+(Sc.active&&d===Sc.active.row?" active":"")+(d%2===1?" odd":"")+(Db(d)?" "+Sc.options.selectedClass:""),i={};if(void 0===g)throw new Error("Unable to render row at index "+d+" because no such row could be found.");Nc?(i=Uc.rowPositions[d],f=i.top-jd):f=Sc.options.rowHeight*d-jd+1*d+(d+1)*Sc.options.rowSpacing,g&&g["class"]&&(h+=" "+("function"==typeof g["class"]?g["class"].bind(Sc)(d,g):g["class"]));var j=Sc.options&&Sc.options.rowStyle?"function"==typeof Sc.options.rowStyle?Sc.options.rowStyle(g):Sc.options.rowStyle:"",k=["<div class='",h,"' style='"+j+"top:",f,"px"];if(Nc&&null!==i.height&&void 0!==i.height){var l=i.height-Vc;k=k.concat(";height:",l,"px;line-height:",l+Sc.options.lineHeightOffset,"px")}k.push("'>"),b.push.apply(b,k),Sc.options.frozenColumns>-1&&c.push.apply(c,k);var m,o,p,q;for(p=0,q=Uc.activeColumns.length;q>p;p++){if(o=Uc.activeColumns[p],m=1,g&&g.columns){var r=g.columns[o.id]||g.columns[p];m=r&&r.colspan||1,"*"===m&&(m=q-p)}if(Uc.columnPosRight[Math.min(q-1,p+m-1)]>e.leftPx){if(Uc.columnPosLeft[p]>e.rightPx)break;Sc.options.frozenColumns>-1&&p>Sc.options.frozenColumns?bc(c,d,p,m,g):bc(b,d,p,m,g)}else Sc.options.frozenColumns>-1&&p<=Sc.options.frozenColumns&&bc(b,d,p,m,g);m>1&&(p+=m-1)}var s=[];Sc.options.resizableRows&&g.resizable!==!1&&(s.push('<div class="'),s.push(n.rowhandle),s.push('"></div>')),s.push("</div>"),b.push.apply(b,s),a.frozenColumns>-1&&c.push.apply(c,s)},fc=function(a){var c,d,e=[],f=[],g=[],h=!1;for(c=a.top,d=a.bottom;d>=c;c++)Uc.nodes[c]||(g.push(c),Uc.nodes[c]={rowNode:null,cellColSpans:[],cellNodesByColumnIdx:[],cellRenderQueue:[]},ec(e,f,c,a),Sc.active&&Sc.active.node&&Sc.active.row===c&&(h=!0),Xc++);if(g.length){var i=document.createElement("div"),j=document.createElement("div");i.innerHTML=e.join(""),j.innerHTML=f.join("");var k=function(a,b){var c=$(b),d=c.data("doby_scrolling");d&&(c.scrollTop(d.top),c.scrollLeft(d.left))};for(c=0,d=g.length;d>c;c++){cd&&g[c]>=Tc?Sc.options.frozenColumns>-1?Uc.nodes[g[c]].rowNode=$().add($(i.firstChild).appendTo(b[2])).add($(j.firstChild).appendTo(b[3])):Uc.nodes[g[c]].rowNode=$().add($(i.firstChild).appendTo(b[2])):Sc.options.frozenColumns>-1?Uc.nodes[g[c]].rowNode=$().add($(i.firstChild).appendTo(b[0])).add($(j.firstChild).appendTo(b[1])):Uc.nodes[g[c]].rowNode=$().add($(i.firstChild).appendTo(b[0]));var l=Uc.nodes[g[c]].rowNode.find(".cache_placeholder");if(l&&l.length){var m=l.data("itemId"),n=l.data("columnId"),o=Uc.postprocess[m][n];l.replaceWith(o),o.find(".doby-grid-viewport").each(k)}}h&&(Sc.active.node=Aa(Sc.active.row,Sc.active.cell))}},this.reset=function(a){return this.collection.reset(a,!0),this},gc=function(){sc(null,!1)},hc=function(){for(var a in Uc.aggregatorsByColumnId)for(var b in Uc.aggregatorsByColumnId[a])Uc.aggregatorsByColumnId[a][b]._processed=!1,"function"==typeof Uc.aggregatorsByColumnId[a][b].reset&&Uc.aggregatorsByColumnId[a][b].reset()},this.resize=function(){if(this.destroyed)return this;var a=Oc;return Sc.options.autoHeight&&lc(),ic(),A&&A.length?this:(xb(),Oc>a&&this.fetcher&&Vb(),this)},ic=function(a){gd&&(Oc=Ya(),Rc=Za(),Q(),B.each(function(a){cd||(a>1?$(this).height(0):($(this).css({bottom:0}),D.eq(0).css({height:Oc}),D.eq(1).css({height:Oc})))}),Jc(),Sc.options.autoColumnWidth&&M(),hd=-1,a&&ac())},jc=function(a,b){var c,d,e,f,g,h,i=r.children("."+n.headercolumn);if(e=b,0>b){for(f=a;f>=0;f--)g=Uc.activeColumns[f],d="headerContent"===Sc.options.minColumnWidth?g._headerWidth:0,g.resizable&&(c=Math.max(g.minWidth||0,G,d),e&&g.previousWidth+e<c?(e+=g.previousWidth-c,g.width=c):(g.width=g.previousWidth+e,e=0));if(Sc.options.autoColumnWidth)for(e=-b,f=a+1;f<i.length;f++)g=Uc.activeColumns[f],g.resizable&&(e&&g.maxWidth&&g.maxWidth-g.previousWidth<e?(e-=g.maxWidth-g.previousWidth,g.width=g.maxWidth):(g.width=g.previousWidth+e,e=0))}else{for(f=a;f>=0;f--)g=Uc.activeColumns[f],g.resizable&&(e&&g.maxWidth&&g.maxWidth-g.previousWidth<e?(e-=g.maxWidth-g.previousWidth,g.width=g.maxWidth):(g.width=g.previousWidth+e,e=0));if(Sc.options.autoColumnWidth)for(e=-b,f=a+1,h=i.length;h>f;f++)g=Uc.activeColumns[f],g.resizable&&(c=Math.max(g.minWidth||0,G),e&&g.previousWidth+e<c?(e+=g.previousWidth-c,g.width=c):(g.width=g.previousWidth+e,e=0))}},kc=function(a,b,c,d,e){if(a){var f=Uc.columnsById[a.id],g=a.width,h=Math.max(Ea(f),a.minWidth);if(c&&(h=Math.min(h,a.maxWidth)),g!=h){var i=b&&b.pageX||Uc.columnPosRight[f];Fb(f);var j=h-g;Rb(f,i);var k=Math.min(Jb,Math.max(Kb,i+j))-i;jc(f,k),K(),(d||"undefined"==typeof d||null===d)&&Dc(e)}}},this.resizeColumnsToContent=function(a,b,c){for(var d=0,e=Uc.activeColumns.length;e>d;d++){var f=Uc.activeColumns[d];kc(f,null,a,!b,c)}return b&&Dc(c),this},lc=function(){var a=Wa()+(Sc.options.showHeader?x.outerHeight()-Xa(x):0)+1;Sc.$el.height(a)},this.restoreState=function(a){var b,c,d=!1;if(void 0!==a.autoColumnWidth&&null!==a.autoColumnWidth&&(this.options.autoColumnWidth=a.autoColumnWidth,d=a.autoColumnWidth),
a.columns){var e,f={};for(b=0,c=a.columns.length;c>b;b++)e=a.columns[b],e.order_index=b,e.id&&(f[e.id]=e);for(b=0,c=this.options.columns.length;c>b;b++)e=this.options.columns[b],e.visible=f[e.id]?!0:!1,e.width=f[e.id]?f[e.id].width:e.width;this.options.columns=_.sortBy(this.options.columns,function(b){return f[b.id]?f[b.id].order_index:a.columns.length+1}),this.setColumns(this.options.columns)}if(d&&gd&&(xc(),M()),a.filters&&this.filter(a.filters),this.options.groupable&&a.grouping&&this.setGrouping(a.grouping),a.sort&&this.setSorting(a.sort),a.resizedRows){var g=a.resizedRows.reduce(function(a,b){return a[b.id]=b.height,a},{});for(b=0,c=Uc.rows.length;c>b;b++){var h=Uc.rows[b],i=h[this.options.idProperty];g.hasOwnProperty(i)&&(h.height=g[i],h.resized=!0)}P(),xb()}},mc=function(a,b,c){pc(a,c);var d=Ia(a,b),e=Uc.columnPosLeft[b],f=Uc.columnPosRight[b+(d>1?d-1:0)],g=qd+Rc;qd>e?(D.scrollLeft(e),qb(),ac()):f>g&&(D.scrollLeft(Math.min(e,f-D[0].clientWidth)),qb(),ac())},oc=function(a){var b,c=a*Pb,d=Ua(rd)+c;if(d=0>d?0:d,Nc){if(!Uc.rowPositions[d])return;b=Uc.rowPositions[d].top}else b=d*(Sc.options.rowHeight+1+Sc.options.rowSpacing);if(qc(b),ac(),Sc.options.activeFollowsPage&&Sc.active&&null!==Sc.active.row){var e=Sc.active.row+c,f=Ka();e>=f&&(e=f-1),0>e&&(e=0);for(var g=0,h=null,i=H;H>=g;)R(e,g)&&(h=g),g+=Ia(e,g);null!==h?(sc(Aa(e,h)),H=i):gc()}},pc=function(a,b){var c,d,e,f=Sc.options.rowHeight+1,g=$a();if(!(g.top<a&&g.bottom-1>a)){Nc?(e=Uc.rowPositions[a],c=e.top,d=e.bottom-Oc+(Pc?window.scrollbarDimensions.height:0)):(c=a*f,d=(a+1+Sc.options.rowSpacing)*f-Oc+(Pc?window.scrollbarDimensions.height:0));var h,i;Nc?(h=e.bottom>rd+Oc+jd,i=e.top<rd+jd):(h=a*(Sc.options.rowHeight+Sc.options.rowSpacing)>rd+jd,i=a*(Sc.options.rowHeight+Sc.options.rowSpacing)<rd+jd),h?(qc(b?c:d),ac()):i&&(qc(b?d:c),ac())}},qc=function(a){a=Math.max(a,0),a=Math.min(a,Ec-Oc+(Pc||Sc.options.frozenColumns>-1?window.scrollbarDimensions.height:0));var b=jd;kd=Math.min(Nb-1,Math.floor(a/Qb)),jd=Math.round(kd*W);var c=a-jd;if(Nc&&Q(),jd!=b){var d=$a(c);Z(d)}if(od!=c){var e=Math.abs(c-od);wd=c+jd>od+b?1:-1,id=rd=od=c,D.eq(0)[0].scrollTop=c,Sc.options.frozenColumns>-1&&(D.eq(1)[0].scrollTop=c),cd&&(D.eq(2)[0].scrollTop=c),Sc.trigger("viewportchanged",null,{scrollLeft:0,scrollTop:rd,scrollLeftDelta:0,scrollTopDelta:e})}},this.scrollToRow=function(a){if(Nc){var b=Uc.rowPositions[a];qc(b.top)}else qc(a*(this.options.rowHeight+1+this.options.rowSpacing)+this.options.rowSpacing);return ac(),this},this.selectCells=function(a,b,c,d,e){if(this.options.selectable){if(void 0===a&&void 0===b&&void 0===c&&void 0===d)return ja(),void this.trigger("selection",this._event,{selection:this.selection});for(var f,g=["startRow","startCell","endRow","endCell"],h=[a,b,c,d],i=0,j=h.length;j>i;i++)if(f=h[i],void 0===f)throw new Error('Unable to select cell range because "'+g[i]+'" param is missing.');var k,m,n,o,p,q=new l({fromRow:a,fromCell:b,toRow:c,toCell:d},this);if(q.excludeUnselectable(),!q.fullyExcluded()){var r={preventSelection:!1,range:q};if(this.trigger("beforeselection",this._event,r),r.preventSelection)return!1;if(q.isSingleCell()&&this.selection)for(m=0,n=this.selection.length;n>m;m++){if(this.selection[m].contains(a,b))return;if(this.selection[m].isExcludedCell(a,b)){var s=this.selection[m].exclusions.indexOf([a,b]);this.selection[m].exclusions.splice(s,1);var t={};return t[a]={},t[a][Uc.activeColumns[b].id]=this.options.selectedClass,void this.updateCellCssStylesOnRenderedRows(t)}}e?(this.selection||(this.selection=[]),k=this.selection,k.push(q)):k=[q],this.selection=k;var u={};for(m=0,n=this.selection.length;n>m;m++)for(o=this.selection[m].fromRow;o<=this.selection[m].toRow;o++)for(u[o]||(u[o]={}),p=Sc.selection[m].fromCell;p<=this.selection[m].toCell;p++)this.canCellBeSelected(o,p)&&!this.selection[m].isExcludedCell(o,p)&&(u[o][Uc.activeColumns[p].id]=this.options.selectedClass);this.updateCellCssStylesOnRenderedRows(u),this.trigger("selection",this._event,{selection:this.selection})}}},this.selectRows=function(a,b,c){var d=this.selectCells(a,0,b,Uc.activeColumns.length-1,c);if(d!==!1)for(var e=a;b>=e;e++){var f=Uc.nodes[e]?Uc.nodes[e].rowNode:null;f&&$(f).addClass(this.options.selectedClass)}return this},sc=function(a,b){Sc.active&&Sc.active.node&&Sc.active.node===a||Sc.trigger("beforeactivecellchange",Sc._event,{}),Sc.active&&null!==Sc.active.node&&(Ib(),$(Sc.active.node).removeClass("active"),Uc.nodes[Sc.active.row]&&$(Uc.nodes[Sc.active.row].rowNode).removeClass("active")),Sc.active||(Sc.active={cell:null,node:null,row:null});var c=Sc.active.node!==a;if(null!==a?(Sc.active.node=a,Sc.active.row=Ta(Sc.active.node.parentNode),Sc.active.cell=H=ya(Sc.active.node),(null===b||void 0===b)&&(b=Sc.active.row==Ka()||Sc.options.autoEdit),$(Sc.active.node).addClass("active"),$(Uc.nodes[Sc.active.row].rowNode).addClass("active"),Sc.options.editable&&b&&Bb(Sc.active.row,Sc.active.cell)&&(clearTimeout($c),Sc.options.asyncEditorLoading?$c=setTimeout(function(){Hb()},Sc.options.asyncEditorLoadDelay):Hb())):Sc.active.row=Sc.active.cell=null,c){var d=ua();d&&(d.item=Sc.getRowFromIndex(d.row)),Sc.trigger("activecellchange",Sc._event,d)}},this.setColumns=function(a){var b={},c=this.options.columns.map(function(a){return b[a.id]=a.aggregators,_.clone(a)});if(this.options.columns=ma(a),Kc(),Hc(),this.setSorting(_.filter(this.sorting,function(a){return Uc.columnsById[a.columnId]})),this.trigger("columnchange",this._event,{columns:a,oldColumns:c}),this.trigger("statechange",this._event),gd){yb(),cc(),Zb(),ga(),ic(!0),J(),qb(),"headerContent"===Sc.options.minColumnWidth&&sa(!0);for(var d,e,f=0,g=a.length;g>f;f++)if(d=b[a[f].id]&&b[a[f].id].aggregators,e=_.findWhere(a[f].aggregators||[],{active:!0}),e&&(a[f].aggregators&&a[f].aggregators.length&&!d||!a[f].aggregators&&d)){this.collection.refresh();break}}},this.setCustomGrouping=function(a){if(!a||!a.length)throw new Error("There must be at least one grouping option to set custom grouping");return bd=!0,this.collection.setGrouping(a,!0),this},tc=function(){if(Sc.options.frozenColumns=Sc.options.frozenColumns>=0&&Sc.options.frozenColumns<Sc.options.columns.length?parseInt(Sc.options.frozenColumns):-1,Sc.options.frozenRows=Sc.options.frozenRows>=0&&Sc.options.frozenRows<Pb?parseInt(Sc.options.frozenRows):-1,Sc.options.frozenRows>-1){cd=!0,Zc=Sc.options.frozenRows*Sc.options.rowHeight;var a=Ka()||this.data.length;Tc=Sc.options.frozenBottom?a-Sc.options.frozenRows:Sc.options.frozenRows}else cd=!1},this.setGrouping=function(a){return bd=!1,this.collection.setGrouping(a),this},this.setItem=function(a,b){return this.collection.setItem(a,b),this},this.setOptions=function(a){Ib(),void 0!==a.addRow&&Sc.options.addRow!==a.addRow&&(a.addRow?vb():this.remove("-add-row-")),a.minColumnWidth&&"headerContent"===a.minColumnWidth&&Sc.options.minColumnWidth!==a.minColumnWidth&&sa();var b=a.rowHeight!=Sc.options.rowHeight;$.extend(!0,Sc.options,a),Lc(),a.autoHeight?D.addClass(n.autoheight):(this.$el.removeAttr("style"),D.removeClass(n.autoheight)),a.columns?this.setColumns(a.columns):b||ac(),tc(),vc(),b&&(yb(),Zb(),ga(),P(),ic(!0),J()),a.data&&!a.columns&&this.reset(a.data),void 0!==a.autoHeight&&null!==a.autoHeight&&this.resize(),"autoColumnWidth"in a&&(xc(),a.autoColumnWidth&&M(),Sc.trigger("columnresize",this._event,{})),Sc.trigger("statechange",this._event,{})},uc=function(a,b){var c=Uc.rows[a];c.height=b,c.resized=!0,Ab(_.range(a,Uc.rows.length)),c._groupRow?(c.predef.height=b,Ab(_.range(a,Uc.rows.length)),P(a),ac()):Sc.collection.setItem(c[Sc.options.idProperty],c),Jc()},vc=function(){Sc.options.frozenColumns>-1?cd?Sc.options.frozenBottom?(E=D.eq(3),F=D.eq(1)):E=F=D.eq(3):E=F=D.eq(1):cd?Sc.options.frozenBottom?(E=D.eq(2),F=D.eq(0)):E=F=D.eq(2):E=F=D.eq(0)},this.setSorting=function(a){if(!$.isArray(a))throw new Error('Doby Grid cannot set the sorting because the "options" parameter must be an array of objects.');var b,c,d=JSON.parse(JSON.stringify(this.sorting));if(!this.options.multiColumnSort&&a.length>1)throw new Error('Doby Grid cannot set the sorting given because "multiColumnSort" is disabled and the given sorting options contain multiple columns.');var e;for(b=0,c=a.length;c>b;b++){if(e=Ca(a[b].columnId),!e)throw new Error(['Doby Grid cannot sort by "',a[b].columnId,'" because that column does not exist.'].join(""));if(e.sortable===!1)throw new Error(['Doby Grid cannot sort by "',e.id,'" because that column is not sortable.'].join(""));(null===a[b].sortAsc||void 0===a[b].sortAsc)&&(a[b].sortAsc=null!==e.sortAsc||void 0!==e.sortAsc?e.sortAsc:!0)}this.sorting=Mb(a),Cc();var f=d.length!=this.sorting.length;if(!f)for(b=0,c=d.length;c>b;b++)if(d[b].columnId!=this.sorting[b].columnId||d[b].sortAsc!=this.sorting[b].sortAsc){f=!0;break}if(f){hc();var g,h={multiColumnSort:this.sorting.length>1,sortCols:[]};for(b=0,c=this.sorting.length;c>b;b++)g=this.sorting[b],e=Ca(g.columnId),h.sortCols.push({sortCol:e,sortAsc:g.sortAsc});oa(h),Sc.trigger("sort",this._event,{sort:h}),Sc.trigger("statechange",this._event),"headerContent"===Sc.options.minColumnWidth&&sa()}return this},wc=function(){Sc.options.showHeader&&(r.filter(":ui-sortable").length||r.sortable({axis:"x",containment:"parent",cursor:"default",distance:3,helper:"clone",placeholder:n.placeholder+" "+n.headercolumn,tolerance:"intersection",start:function(a,b){b.placeholder.width(b.helper.outerWidth()-dd),$(b.helper).addClass(n.headercolumnactive)},beforeStop:function(a,b){$(b.helper).removeClass(n.headercolumnactive)},update:function(a,b){a.stopPropagation();var c=function(a,b,c){if(c>=a.length)for(var d=c-a.length;d--+1;)this.push(void 0);a.splice(c,0,a.splice(b,1)[0])},d=_.pluck(Sc.options.columns,"id"),e=$(b.item).attr("id").replace(vd,""),f=d.indexOf(e),g=$(b.item).prev(),h=Sc.options.columns.map(function(a){return _.clone(a)});if(g.length){var i=g.attr("id").replace(vd,""),j=d.indexOf(i);f>j?c(h,f,j+1):c(h,f,j)}else c(h,f,0);Sc.setColumns(h),xc(),Sc.trigger("columnreorder",a,{columns:Sc.options.columns})}}))},xc=function(){if(Sc.options.showHeader&&Sc.options.resizableColumns){var a,b,c,d;b=r.children("."+n.headercolumn);var e=b.find("."+n.handle);e&&e.length&&q(e[0]),b.each(function(a){Uc.activeColumns[a].resizable&&(void 0===c&&(c=a),d=a)}),void 0!==c&&(r.on("dblclick",function(a){if($(a.target).closest("."+n.handle).length){var b=Ha(a);kc(b,a)}}),$.each(b,function(b,e){c>b||Sc.options.autoColumnWidth&&b>=d||Uc.activeColumns[b].resizable===!1||$('<div class="'+n.handle+'"><span></span></div>').appendTo(e).on("dragstart",function(c){a=c.pageX,$(this).parent().addClass(n.headercolumndrag),Fb(b),Rb(b,a)}).on("drag",function(c){var d=Math.min(Jb,Math.max(Kb,c.pageX))-a;jc(b,d),K()}).on("dragend",function(){setTimeout(function(){$(this).parent().removeClass(n.headercolumndrag)}.bind(this),1),Dc(),Ac(rd)})}))}},yc=function(){Sc.options.showHeader&&x.click(function(a){Sc._event=a;var b=$(a.target).closest("."+n.handle).length||$(a.target).hasClass(n.headercolumndrag);if(!b){var c=Ha(a);if(c&&c.sortable){for(var d=null,e=0,f=Sc.sorting.length;f>e;e++)if(Sc.sorting[e].columnId==c.id&&!Sc.sorting[e].group){d=JSON.parse(JSON.stringify(Sc.sorting[e])),d.sortAsc=!d.sortAsc;break}var g=[];a.shiftKey&&Sc.options.multiColumnSort?d?(g=JSON.parse(JSON.stringify(Sc.sorting)),g.splice(e,1)):(g=JSON.parse(JSON.stringify(Sc.sorting)),g.push({columnId:c.id,sortAsc:c.sortAsc})):d?Sc.options.multiColumnSort?(g=JSON.parse(JSON.stringify(Sc.sorting)),g[e].sortAsc=!g[e].sortAsc):g=[d]:g=[{columnId:c.id,sortAsc:c.sortAsc}],Sc.setSorting(g),Sc._event=null}}})},this.showOverlay=function(a){return a=a||{},yb(),A&&A.length&&q(A[0]),A=$(['<div class="doby-grid-overlay',a["class"]?" "+a["class"]:"",'">',a.html||"","</div>"].join("")).appendTo(b),this},this.showQuickFilter=function(a){if(Sc.options.showHeader&&Sc.options.quickFilter){var c=function(){Oc=Ya(),D.height(Oc),ic(!0)};if((void 0===a||null===a)&&u)return u.each(function(){q(this)}),u=void 0,c(),void b.eq(0).focus();var d,e=function(a){if(27==a.keyCode)return void Sc.showQuickFilter();var b=$(this).val();""===b&&(b=null),$(this).data("old_value")!=b&&($(this).data("old_value",b),d&&clearTimeout(d),d=setTimeout(function(){for(var a,b,c=[],d=0,e=Uc.activeColumns.length;e>d;d++)a=Uc.activeColumns[d],a.quickFilterInput&&(b=a.quickFilterInput.val(),b.length&&c.push([a.id,"~*",b]));Sc.filter(c)},150))},f=Uc.columnsById[a];if(u)f&&f.quickFilterInput&&f.quickFilterInput.select().focus();else{u=$(),v=$('<div class="'+n.headerfilter+'"></div>').appendTo(y),w=$('<div class="'+n.headerfilter+'"></div>').appendTo(z),u=u.add(v),u=u.add(w);for(var g,h,i,j=0,k=Uc.activeColumns.length;k>j;j++)if(g=Uc.activeColumns[j],i=['<div class="'],i.push(n.headerfiltercell),g.filterable||i.push(" "+n.headerfilterdisabled),i.push('">'),i.push("</div>"),h=$(i.join("")),j<=Sc.options.frozenColumns||Sc.options.frozenColumns<0?h.appendTo(v):h.appendTo(w),g.filterable){var l=null;if(Sc.collection.filterset)for(var m=0,o=Sc.collection.filterset.length;o>m;m++)if(Sc.collection.filterset[m][0]==g.id){l=Sc.collection.filterset[m][2];break}g.quickFilterInput=$('<input class="'+n.editor+'" type="text"/>').appendTo(h).data("column_id",g.id).attr("placeholder",Qa("column.add_quick_filter")).val(l).on("keyup",e),a==g.id&&g.quickFilterInput.select().focus()}}return I(),c(),this}},this.sortBy=function(a,b){if(!a)throw new Error("Grid cannot sort by blank value. Column Id must be specified.");return this.setSorting([{columnId:a,sortAsc:b}])},zc=function(){Yc&&(clearTimeout(ad),ad=setTimeout(L,Sc.options.asyncPostRenderDelay))},Ac=function(a){if(Sc.options.stickyGroupRows&&Sc.isGrouped()){Uc.stickyGroups||(Uc.stickyGroups=[]);var c=Ua(a),d=Oa(c),e=[d];if(d){var f=function(a){a.parentGroup&&(e.push(a.parentGroup),f(a.parentGroup))};f(d);for(var g=!1,h=0,i=e.length;i>h;h++)if(!Uc.stickyGroups[h]||e[h].id!==Uc.stickyGroups[h].id){g=!0;break}var j,k=e.length,l=D.eq(0).position().top,m=k&&e[0].collapsed?!0:!1,o=k&&null===e[0].value&&!e[0].predef.groupNulls||""===e[0].value&&!e[0].predef.groupEmpty;if((0===a||m||o||g)&&(Uc.stickyRows=[],B.children("."+n.sticky).remove()),0!==a)for(Uc.stickyGroups=e;k--;)if(j=e[k],0===j.collapsed&&j.sticky){sd.push(j[Sc.options.idProperty]);var p,q=Uc.stickyRows[k];if(q&&q.length&&q.attr("rel")==j[Sc.options.idProperty])p=q;else{var r="."+n.sticky+'[rel="'+j[Sc.options.idProperty]+'"]:first';p=B.children(r),p.length&&p.remove();var s=Uc.indexById[j[Sc.options.idProperty]],t=Uc.nodes[s];if(void 0===s)continue;if(t){var u=$(t.rowNode);p=u.clone()}else{var v=[],w=[];ec(v,w,s,{bottom:s,leftPx:0,top:s,rightPx:Sc.$el.width()}),p=$(),p=p.add($(v.join(""))),p=p.add($(w.join("")))}p.addClass(n.sticky).attr("rel",j[Sc.options.idProperty]).removeClass(n.grouptoggle),p.eq(0).width(b.eq(0).css("width")).appendTo(B.eq(0)),p.length>1&&p.eq(1).width(b.eq(1).css("width")).appendTo(B.eq(1)),Uc.stickyRows[k]=p}p.css("top",l),l+=p.outerHeight()}}}},Cc=function(){if(Sc.options.showHeader&&Sc.options.showSortIndicator){var a=r.children();a.removeClass(n.headercolumnsorted).find("."+n.sortindicator).removeClass(n.sortindicatorasc+" "+n.sortindicatordesc),$.each(Sc.sorting,function(b,c){null===c.sortAsc&&(c.sortAsc=!0);var d=Uc.columnsById[c.columnId];null===d||c.group||a.eq(d).addClass(n.headercolumnsorted).find("."+n.sortindicator).addClass(c.sortAsc?n.sortindicatorasc:n.sortindicatordesc)})}},Dc=function(a){var b,c,d,e=r.children("."+n.headercolumn);for(c=0;c<e.length;c++)d=Uc.activeColumns[c],b=$(e[c]).outerWidth(),d.previousWidth!==b&&d.rerenderOnResize&&yb();Gc(!0),ac(),a||Sc.trigger("columnresize",Sc._event,{columns:Sc.options.columns}),Sc.trigger("statechange",Sc._event)},this.toString=function(){return"DobyGrid"},Fc=function(a,b){if(a.preventDefault(),window._DobyGridDropdownEvent!==a.timeStamp){window._DobyGridDropdownEvent=a.timeStamp;for(var c,d,e=b.column||!1,f=function(a){return function(b){b.stopPropagation();var c=Sc.options.columns.map(function(c){var d=_.clone(c);return d.id===a.id&&(d.visible=!d.visible,d.visible?$(b.currentTarget).addClass("on"):$(b.currentTarget).removeClass("on")),d});Sc.setColumns(c)}},g=[],i="--UNDEFINED--",j=_.chain(Sc.options.columns).sortBy(function(a){return a.name}).groupBy(function(a){return void 0!==a.category&&null!==a.category?a.category:i}).value(),k=Object.keys(j).sort(),l=function(a,b){a.removable&&(b=b||g,b.push({name:void 0!==a.name&&null!==a.name?a.name:a.id,fn:f(a),value:a.visible}))},m=0,o=k.length;o>m;m++)if(c=k[m],c!=i){d={name:c,menu:[]};for(var p=0,q=j[c].length;q>p;p++)l(j[c][p],d.menu);g.push(d)}if(j[i])for(var r=0,s=j[i].length;s>r;r++)l(j[i][r]);var t=function(a,b){return function(c){if(1!==Object.keys(Uc.aggregatorsByColumnId[a.id]).length){$(c.target).parent().children("."+n.dropdownitem).removeClass("on"),$(c.target).addClass("on"),$(c.target).children("."+n.dropdownicon).length||$(c.target).append('<span class="'+n.dropdownicon+'"></span>');for(var d in Uc.aggregatorsByColumnId[a.id])Uc.aggregatorsByColumnId[a.id][d].active=d==b;for(var e=$a(),f=e.top,g=e.bottom;g>f;f++)Uc.rows[f]&&Uc.rows[f]._aggregateRow&&Ab([f]);hc(),Sc.collection.refresh()}}},v=[];if(e&&Uc.aggregatorsByColumnId[e.id])for(var w in Uc.aggregatorsByColumnId[e.id])v.push({fn:t(e,w),name:e.aggregators[w].name,value:Uc.aggregatorsByColumnId[e.id][w].active});var x=[{enabled:e||Sc.options.quickFilter,name:Qa("column.options"),title:!0},{enabled:e&&e.removable,name:e?Qa("column.remove",{name:e.name}):"",fn:function(){Sc.hideColumn(e.id)}},{enabled:Sc.options.quickFilter,name:Qa("column.filtering"),menu:[{enabled:e,name:e?Qa("column.filter",{name:e.name}):"",fn:function(){Sc.showQuickFilter(e.id),Sc.dropdown.hide()}},{enabled:void 0!==u,name:Qa("global.hide_filter"),fn:function(){Sc.showQuickFilter(),Sc.dropdown.hide()}}]},{enabled:e&&e.sortable,name:Qa("column.sorting"),menu:[{enabled:!tb(e.id),name:e?Qa("column.sort_asc",{name:e.name}):"",fn:function(){Sc.sortBy(e.id,!0),Sc.dropdown.hide()}},{enabled:!tb(e.id),name:e?Qa("column.sort_desc",{name:e.name}):"",fn:function(){Sc.sortBy(e.id,!1),Sc.dropdown.hide()}},{enabled:Sc.isSorted()&&!tb(e.id),name:e?Qa("column.add_sort_asc",{name:e.name}):"",fn:function(){Sc.sorting.push({columnId:e.id,sortAsc:!0}),Sc.setSorting(Sc.sorting),Sc.dropdown.hide()}},{enabled:Sc.isSorted()&&!tb(e.id),name:e?Qa("column.add_sort_desc",{name:e.name}):"",fn:function(){Sc.sorting.push({columnId:e.id,sortAsc:!1}),Sc.setSorting(Sc.sorting),Sc.dropdown.hide()}},{enabled:tb(e.id),name:e?Qa("column.remove_sort",{name:e.name}):"",fn:function(){Sc.setSorting(_.filter(Sc.sorting,function(a){return a.columnId!=e.id})),Sc.dropdown.hide()}}]},{enabled:Sc.options.groupable&&e&&e.groupable,name:Qa("column.grouping"),menu:[{enabled:!sb(e.id)||!Sc.isGrouped(),name:e?Qa("column.group",{name:e.name}):"",fn:function(){Sc.setGrouping([{column_id:e.id}]),Sc.dropdown.hide()}},{enabled:!sb(e.id)&&Sc.isGrouped(),name:e?Qa("column.add_group",{name:e.name}):"",fn:function(){Sc.addGrouping(e.id),Sc.dropdown.hide()}},{enabled:sb(e.id),name:e?Qa("column.remove_group",{name:e.name}):"",fn:function(){Sc.removeGrouping(e.id),Sc.dropdown.hide()}},{enabled:Sc.isGrouped(),name:Qa("column.groups_clear"),fn:function(){Sc.setGrouping(),Sc.dropdown.hide()}},{enabled:Sc.isGrouped(),divider:!0},{enabled:Sc.isGrouped(),name:Qa("column.groups_expand"),fn:function(){Sc.collection.expandAllGroups()}},{enabled:Sc.isGrouped(),name:Qa("column.groups_collapse"),fn:function(){Sc.collection.collapseAllGroups()}}]},{enabled:e&&void 0!==e.aggregators,name:Qa("column.aggregators"),menu:v},{name:Qa("global.grid_options"),title:!0},{name:Qa("selection.selection"),menu:[{name:Qa("selection.select_all",{name:e.name}),fn:function(){Sc.selectCells(0,0,Uc.rows.length-1,Uc.activeColumns.length-1),Sc.dropdown.hide()}},{enabled:e&&!Eb(Uc.columnsById[e.id]),name:Qa("selection.select_column",{name:e.name}),fn:function(){var a=Uc.columnsById[e.id];Sc.selectCells(0,a,Uc.rows.length-1,a),Sc.dropdown.hide()}},{enabled:void 0!==b.cell&&null!==b.cell&&!Cb(b.row,b.cell),name:Qa("selection.select_cell"),fn:function(){Sc.selectCells(b.row,b.cell,b.row,b.cell),Sc.dropdown.hide()}},{name:Qa("selection.deselect_all",{name:e.name}),fn:function(){ja(),Sc.dropdown.hide()}},{enabled:e&&Eb(Uc.columnsById[e.id]),name:Qa("selection.deselect_column",{name:e.name}),fn:function(){for(var a=Uc.columnsById[e.id],b=0;b<Uc.rows.length-1;b++)ja(b,a)}},{enabled:void 0!==b.cell&&null!==b.cell&&Cb(b.row,b.cell),name:Qa("selection.deselect_cell"),fn:function(){ja(b.row,b.cell),Sc.dropdown.hide()}}]},{enabled:g.length>0,name:Qa("global.columns"),menu:g},{enabled:fd,name:Qa("global.export"),menu:[{name:Qa("global.export_csv"),fn:function(){Sc["export"]("csv",function(a){var b=new Blob([a],{type:"text/csv;charset=utf-8"});saveAs(b,[Sc.options.exportFileName,".csv"].join(""))}),Sc.dropdown.hide()}},{name:Qa("global.export_html"),fn:function(){Sc["export"]("html",function(a){var b=new Blob([a],{type:"text/html;charset=utf-8"});saveAs(b,[Sc.options.exportFileName,".html"].join(""))}),Sc.dropdown.hide()}},{enabled:Sc.isGrouped()&&"undefined"!=typeof b.row,name:Qa("global.export_group_csv"),fn:function(){Sc["export"]("csv",function(a){var b=new Blob([a],{type:"text/csv;charset=utf-8"});saveAs(b,[Sc.options.exportFileName,".csv"].join(""))},b.row),Sc.dropdown.hide()}},{enabled:Sc.isGrouped()&&"undefined"!=typeof b.row,name:Qa("global.export_group_html"),fn:function(){Sc["export"]("html",function(a){var b=new Blob([a],{type:"text/html;charset=utf-8"});saveAs(b,[Sc.options.exportFileName,".html"].join(""))},b.row),Sc.dropdown.hide()}}]},{name:Qa("global.auto_width"),value:Sc.options.autoColumnWidth,fn:function(){Sc.setOptions({autoColumnWidth:!Sc.options.autoColumnWidth})}}];if(Sc.options.menuExtensions){var y=function(a){if(a.fn){var b=a.fn;a.fn=function(a){var c=b(a);return Sc.dropdown.hide(),c}}if(a.menu)for(var c=0,d=a.menu.length;d>c;c++)a.menu[c]=y(a.menu[c]);return a};void 0!==b.row&&null!==b.row&&(b.item=Uc.rows[b.row]);var z=Sc.options.menuExtensions(a,Sc,b),A=z?z.filter(function(a){return void 0===a.enabled||a.enabled}):[];if(A.length){for(var B=[{name:Qa("global.extensions"),title:!0}],C=0,D=A.length;D>C;C++)B.push(y(A[C]));x="top"===Sc.options.menuExtensionsPosition?B.concat(x):x.concat(B)}}var E=$('<div class="'+n.contextmenu+'"></div>');dc(x,E);var F;E.on("mouseover",function(a){F&&clearTimeout(F);var b=$(a.target).hasClass(n.dropdownitem)?$(a.target):$(a.target).parent().hasClass(n.dropdownitem)?$(a.target).parent():null;b&&(F=setTimeout(function(){b.parent().children(".open").removeClass("open"),b.addClass("open")},200))}),Sc.dropdown=new h(a,{id:e.id,menu:E,parent:Sc.$el})}},Gc=function(a){var c,d=S,e=T,f=U;S=wa(),c=S!==d||T!==e||U!==f,c&&(Sc.options.frozenColumns>-1?(B.eq(0).width(T),B.eq(1).css({left:T+"px"})):(B.eq(0).css({right:0,width:"auto"}),B.eq(1).css({width:0})),b.eq(0).width(T),b.eq(1).width(Sc.options.fullWidthRows?S-T:U),Sc.options.showHeader&&r.width(Pa()),Pc=S>Rc-window.scrollbarDimensions.width),(c||a)&&J()},this.updateCellCssStylesOnRenderedRows=function(a,b){var c,d,e,f;for(var g in Uc.nodes){if(f=b&&b[g],e=a&&a[g],f){for(d in f)e&&f[d]==e[d]||(c=Aa(g,Uc.columnsById[d]),c&&$(c).removeClass(f[d]));Object.keys(f).length===Uc.activeColumns.length&&$(Uc.nodes[g].rowNode).removeClass(Sc.options.selectedClass)}if(e)for(d in e)f&&f[d]==e[d]||(c=Aa(g,Uc.columnsById[d]),c&&$(c).addClass(e[d]))}},Hc=function(a){(null===a||void 0===a)&&(a=!0),Uc.columnPosLeft=[],Uc.columnPosRight=[],a&&(Uc.aggregatorsByColumnId={});for(var b,c=0,d=0,e=Uc.activeColumns.length;e>d;d++)if(b=Uc.activeColumns[d],Uc.columnPosLeft[d]=c,Uc.columnPosRight[d]=c+b.width,c+=b.width,a&&b.aggregators)for(var f=0,g=b.aggregators.length;g>f;f++)Uc.aggregatorsByColumnId[b.id]||(Uc.aggregatorsByColumnId[b.id]={}),Uc.aggregatorsByColumnId[b.id][f]=new b.aggregators[f].fn(b),"function"==typeof Uc.aggregatorsByColumnId[b.id][f].reset&&Uc.aggregatorsByColumnId[b.id][f].reset()},this.updateRow=Ic=function(a){var b=Uc.nodes[a];if(b){na(a);var c=Sc.getRowFromIndex(a);for(var d in b.cellNodesByColumnIdx)if(b.cellNodesByColumnIdx.hasOwnProperty(d)){d=0|d;var e=Uc.activeColumns[d],f=b.cellNodesByColumnIdx[d][0];Sc.active&&a===Sc.active.row&&d===Sc.active.cell&&Sc.currentEditor?Sc.currentEditor.loadValue(c):c?f.innerHTML=Ma(c,e)(a,d,Ja(c,e),e,c):f.innerHTML=""}zb(a)}},Jc=function(){if(gd){var a=Uc.rows.length,c=Qc;if(0===a)Qc=!1;else if(Nc){var d=Uc.rowPositions[a-1];Qc=d&&d.bottom>Oc}else Qc=a*(Sc.options.rowHeight+Sc.options.rowSpacing)>Oc;Ib();for(var e in Uc.nodes)e>=a&&_b(e);Sc.active&&Sc.active.node&&Sc.active.row>a&&gc();var f=gb;if(0===a)Ec=Oc-window.scrollbarDimensions.height;else{var g;if(Nc){var h=a-1,i=Uc.rowPositions[h];g=i.bottom}else g=(Sc.options.rowHeight+Sc.options.rowSpacing)*a+a;Ec=Math.max(g,Oc-window.scrollbarDimensions.height)}Ec<window.maxSupportedCssHeight?(gb=Qb=Ec,Nb=1,W=0):(gb=window.maxSupportedCssHeight,Qb=gb/100,Nb=Math.floor(Ec/Qb),W=(Ec-gb)/(Nb-1)),gb!==f&&(b.css("height",gb),rd=D[0].scrollTop);var j=Ec-Oc>=rd+jd;0===Ec||0===rd?kd=jd=0:qc(j?rd+jd:Ec-Oc+(Pc?window.scrollbarDimensions.height:0)),Sc.options.autoColumnWidth&&void 0!==c&&c!=Qc&&M(),Gc(!1)}},Kc=function(){if(Sc.options.columns){Uc.activeColumns=[],Uc.columnsById={};for(var a,b={},c=0,d=Sc.options.columns.length;d>c;c++){if(void 0===Sc.options.columns[c])throw new TypeError("You have an 'undefined' column object in your Grid Options. This is not allowed.");if(null===Sc.options.columns[c])throw new TypeError("You have a 'null' column object in your Grid Options. This is not allowed.");if(a=Sc.options.columns[c]=$.extend(JSON.parse(JSON.stringify(xd)),Sc.options.columns[c]),(void 0===a.id||null===a.id)&&(a.id=a.field?a.field+"_"+c:a.name?a.name+"_"+c:null),b[a.id])throw new Error(["You cannot have two columns with the same 'id' value. ","Please change one of the '",a.id,"' column 'id' values."].join(""));a.postprocess&&(Yc=!0),(void 0===a.width||null===a.width)&&(a.width=Sc.options.columnWidth),void 0!==a.minWidth&&null!==a.minWidth&&a.width<a.minWidth&&(a.width=a.minWidth),void 0!==a.maxWidth&&null!==a.maxWidth&&a.width>a.maxWidth&&(a.width=a.maxWidth);for(var e,f=["editor","exporter","formatter"],g=0,h=f.length;h>g;g++)if(e=f[g],void 0!==a[e]&&null!==a[e]&&"function"!=typeof a[e])throw new Error(["Column ",e,"s must be functions. ","Invalid ",e,' given for column "',a.name||a.id,'"'].join(""));if(void 0!==a.aggregators&&null!==a.aggregators&&!$.isArray(a.aggregators))throw new Error(['A column\'s "aggregators" value must be array. ','Invalid value given for column "',a.name||a.id,'"'].join(""));a.visible!==!1&&(Uc.activeColumns.push(a),Uc.columnsById[a.id]=Uc.activeColumns.length-1),b[a.id]=!0}}},Lc=function(){if(Sc.options.resizableColumns&&!$.fn.drag)throw new Error('In order to use "resizable", you must ensure the jquery-ui.draggable module is loaded.');if(Sc.options.reorderable&&!$.fn.sortable)throw new Error('In order to use "reorderable", you must ensure the jquery-ui.sortable module is loaded.');if(!$.isArray(Sc.options.columns))throw new TypeError('The "columns" option must be an array.');if(!($.isArray(Sc.options.data)||"function"==typeof Sc.options.data||Sc.options.data instanceof Backbone.Collection))throw new TypeError('The "data" option must be an array, a function or a Backbone.Collection.');if("function"==typeof Sc.options.data?Sc.fetcher=new Sc.options.data:Sc.options.data instanceof Backbone.Collection&&Sc.options.data.DobyGridRemote&&(Sc.fetcher=Sc.options.data.DobyGridRemote),Sc.fetcher&&(Sc.fetcher.grid=Sc,Sc.fetcher.queue=$.when()),["title","popup"].indexOf(Sc.options.tooltipType)<0)throw new Error('The "tooltipType" option be either "title" or "popup", not "'+Sc.options.tooltipType+'".');Sc.options.addRow&&!Sc.options.editable&&(console.warn&&console.warn('In order to use "addRow", you must enable the "editable" parameter. The "addRow" option has been disabled.'),Sc.options.addRow=!1),Sc.options.resizableRows&&!Nc&&(Nc=!0),Kc(),Sc.options.data instanceof Backbone.Collection&&Gb()},Mc=function(a){if(!$.isArray(a))throw new Error("Unable to group rows because the data returned from your remote fetchGroups method is not valid. It must be an array.");for(var b,c,d=0,e=a.length;e>d;d++){c={},$.isArray(a[d].parent)||(a[d].parent=[a[d].parent]);for(var f=0,g=a[d].groups.length;g>f;f++)b=a[d].groups[f],c[b.value]||(c[b.value]={}),!b.parent&&1===c[b.value]||b.parent&&c[b.value][b.parent.toString()]?console.warn("The data returned from your remote fetchGroups method is not valid. More than 1 group with the value `"+b.value+"` and parents `"+(b.parent?b.parent.toString():"")+"` detected at grouping level "+d+"."):b.parent?c[b.value][b.parent.toString()]=1:c[b.value]=1}},ub()};b.exports=r},{"./classes/Aggregate":1,"./classes/CellRangeDecorator":2,"./classes/DefaultEditor":3,"./classes/DefaultFormatter":4,"./classes/Dropdown":5,"./classes/Group":6,"./classes/NonDataItem":7,"./classes/Placeholder":8,"./classes/Range":9,"./classes/Tooltip":10,"./utils/classes":12,"./utils/locales":13,"./utils/naturalSort":14,"./utils/removeElement":15}],12:[function(a,b,c){"use strict";var d="doby-grid";b.exports={autoheight:d+"-autoheight",canvas:d+"-canvas",cell:d+"-cell",cellunselectable:d+"-cell-unselectable",clipboard:d+"-clipboard",collapsed:"collapsed",columnname:d+"-column-name",columnspacer:d+"-column-spacer",contextmenu:d+"-contextmenu",dropdown:d+"-dropdown",dropdownmenu:d+"-dropdown-menu",dropdownitem:d+"-dropdown-item",dropdowndivider:d+"-dropdown-divider",dropdownarrow:d+"-dropdown-arrow",dropdownicon:d+"-dropdown-icon",dropdownleft:d+"-dropdown-left",dropdowntitle:d+"-dropdown-title",editor:d+"-editor",empty:d+"-empty",expanded:"expanded",garbage:"DobyGridGarbageBin",group:d+"-group",grouptitle:d+"-group-title",grouptoggle:d+"-group-toggle",gutter:d+"-gutter",guttersVisible:d+"-gutters-visible",handle:d+"-resizable-handle",header:d+"-header",headercolumns:d+"-header-columns",headercolumn:d+"-header-column",headercolumnactive:d+"-header-column-active",headercolumndrag:d+"-header-column-dragging",headercolumnsorted:d+"-header-column-sorted",headerfilter:d+"-header-filter",headerfiltercell:d+"-header-filter-cell",headerfilterdisabled:d+"-header-filter-disabled",headersortable:"sortable",invalid:"invalid",invalidicon:d+"-invalid-icon",left:d+"-scrollbar-left",noright:d+"-no-right",pane:d+"-pane",paneactive:d+"-pane-active",placeholder:d+"-sortable-placeholder",rangedecorator:d+"-range-decorator",rangedecoratorstat:d+"-range-decorator-stats",row:d+"-row",rowdragcontainer:d+"-row-drag-container",rowhandle:d+"-row-handle",rowtotal:d+"-row-total",scrollloader:d+"-scroll-loader",sortindicator:d+"-sort-indicator",sortindicatorasc:d+"-sort-indicator-asc",sortindicatordesc:d+"-sort-indicator-desc",sticky:d+"-sticky",tooltip:d+"-tooltip",tooltiparrow:d+"-tooltip-arrow",viewport:d+"-viewport"}},{}],13:[function(a,b,c){b.exports={column:{add_group:'Add Grouping By "{{name}}"',add_sort_asc:'Add Sort By "{{name}}" (Ascending)',add_sort_desc:'Add Sort By "{{name}}" (Descending)',add_quick_filter:"Add Quick Filter...",aggregators:"Aggregators",filter:'Quick Filter by "{{name}}"',filtering:"Filtering",group:'Group By "{{name}}"',grouping:"Grouping",groups_clear:"Clear All Grouping",groups_collapse:"Collapse All Groups",groups_expand:"Expand All Groups",options:"Column Options",remove:'Remove "{{name}}" Column',remove_group:'Remove Grouping By "{{name}}"',remove_sort:'Remove Sort By "{{name}}"',sorting:"Sorting",sort_asc:'Sort By "{{name}}" (Ascending)',sort_desc:'Sort By "{{name}}" (Descending)'},empty:{"default":"No data available",remote:"No results found",filter:"No items matching that filter"},global:{auto_width:"Automatically Resize Columns",columns:"Columns","export":"Export",export_csv:"Export Table to CSV",export_html:"Export Table to HTML",export_group_csv:"Export Group to CSV",export_group_html:"Export Group to HTML",extensions:"Extensions",grid_options:"Grid Options",
hide_filter:"Hide Quick Filter"},selection:{deselect_all:"Deselect All",deselect_cell:"Deselect This Cell",deselect_column:'Deselect "{{name}}" Column',selection:"Selection",select_all:"Select All",select_cell:"Select This Cell",select_column:'Select "{{name}}" Column'}}},{}],14:[function(a,b,c){"use strict";b.exports=function(a,b){var c,d,e=/(^-?[0-9]+(\.?[0-9]*)[df]?e?[0-9]?$|^0x[0-9a-f]+$|[0-9]+)/gi,f=/(^[ ]*|[ ]*$)/g,g=/(^([\w ]+,?[\w ]+)?[\w ]+,?[\w ]+\d+:\d+(:\d+)?[\w ]?|^\d{1,4}[\/\-]\d{1,4}[\/\-]\d{1,4}|^\w+, \w+ \d+, \d{4})/,h=/^0x[0-9a-f]+$/i,i=/^0/,j=function(a){return(""+a).toLowerCase()||""+a},k=j(a).replace(f,"")||"",l=j(b).replace(f,"")||"",m=k.replace(e,"\x00$1\x00").replace(/\0$/,"").replace(/^\0/,"").split("\x00"),n=l.replace(e,"\x00$1\x00").replace(/\0$/,"").replace(/^\0/,"").split("\x00"),o=parseInt(k.match(h),10)||1!=m.length&&k.match(g)&&Date.parse(k),p=parseInt(l.match(h),10)||o&&l.match(g)&&Date.parse(l)||null;if(p){if(p>o)return-1;if(o>p)return 1}for(var q=0,r=Math.max(m.length,n.length);r>q;q++){if(c=!(m[q]||"").match(i)&&parseFloat(m[q])||m[q]||0,d=!(n[q]||"").match(i)&&parseFloat(n[q])||n[q]||0,isNaN(c)!==isNaN(d))return isNaN(c)?1:-1;if(typeof c!=typeof d&&(c+="",d+=""),d>c)return-1;if(c>d)return 1}return 0}},{}],15:[function(a,b,c){"use strict";var d=a("./../utils/classes");b.exports=function(a){var b=document.getElementById(d.garbage);b||(b=document.createElement("DIV"),b.id=d.garbage,b.style.display="none",document.body.appendChild(b)),b.appendChild(a),b.innerHTML=""}},{"./../utils/classes":12}]},{},[11])(11)});
//# sourceMappingURL=.